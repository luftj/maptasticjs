/*! maptastic 2019-11-18 */
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(require,module,exports){(function(global){var numeric=void 0===exports?function(){}:exports;void 0!==global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(a,b){var c,d,e,f;for(void 0===b&&(b=15),e=.5,c=new Date;;){for(e*=2,f=e;f>3;f-=4)a(),a(),a(),a();for(;f>0;)a(),f--;if((d=new Date)-c>b)break}for(f=e;f>3;f-=4)a(),a(),a(),a();for(;f>0;)a(),f--;return d=new Date,1e3*(3*e-1)/(d-c)},numeric._myIndexOf=function(a){var b,c=this.length;for(b=0;b<c;++b)if(this[b]===a)return b;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(a){function b(a){if(0===a)return"0";if(isNaN(a))return"NaN";if(a<0)return"-"+b(-a);if(isFinite(a)){var c=Math.floor(Math.log(a)/Math.log(10)),d=a/Math.pow(10,c),e=d.toPrecision(numeric.precision);return 10===parseFloat(e)&&(c++,d=1,e=d.toPrecision(numeric.precision)),parseFloat(e).toString()+"e"+c.toString()}return"Infinity"}function c(a){var e;if(void 0===a)return d.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof a)return d.push('"'+a+'"'),!1;if("boolean"==typeof a)return d.push(a.toString()),!1;if("number"==typeof a){var f=b(a),g=a.toPrecision(numeric.precision),h=parseFloat(a.toString()).toString(),i=[f,g,h,parseFloat(g).toString(),parseFloat(h).toString()];for(e=1;e<i.length;e++)i[e].length<f.length&&(f=i[e]);return d.push(Array(numeric.precision+8-f.length).join(" ")+f),!1}if(null===a)return d.push("null"),!1;if("function"==typeof a){d.push(a.toString());var j=!1;for(e in a)a.hasOwnProperty(e)&&(j?d.push(",\n"):d.push("\n{"),j=!0,d.push(e),d.push(": \n"),c(a[e]));return j&&d.push("}\n"),!0}if(a instanceof Array){if(a.length>numeric.largeArray)return d.push("...Large Array..."),!0;var j=!1;for(d.push("["),e=0;e<a.length;e++)e>0&&(d.push(","),j&&d.push("\n ")),j=c(a[e]);return d.push("]"),!0}d.push("{");var j=!1;for(e in a)a.hasOwnProperty(e)&&(j&&d.push(",\n"),j=!0,d.push(e),d.push(": \n"),c(a[e]));return d.push("}"),!0}var d=[];return c(a),d.join("")},numeric.parseDate=function(a){function b(a){if("string"==typeof a)return Date.parse(a.replace(/-/g,"/"));if(!(a instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var c,d=[];for(c=0;c<a.length;c++)d[c]=b(a[c]);return d}return b(a)},numeric.parseFloat=function(a){function b(a){if("string"==typeof a)return parseFloat(a);if(!(a instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var c,d=[];for(c=0;c<a.length;c++)d[c]=b(a[c]);return d}return b(a)},numeric.parseCSV=function(a){var b,c,d=a.split("\n"),e=[],f=/(([^'",]*)|('[^']*')|("[^"]*")),/g,g=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,h=function(a){return a.substr(0,a.length-1)},i=0;for(c=0;c<d.length;c++){var j,k=(d[c]+",").match(f);if(k.length>0){for(e[i]=[],b=0;b<k.length;b++)j=h(k[b]),g.test(j)?e[i][b]=parseFloat(j):e[i][b]=j;i++}}return e},numeric.toCSV=function(a){var b,c,d,e,f,g=numeric.dim(a);for(d=g[0],g[1],f=[],b=0;b<d;b++){for(e=[],c=0;c<d;c++)e[c]=a[b][c].toString();f[b]=e.join(", ")}return f.join("\n")+"\n"},numeric.getURL=function(a){var b=new XMLHttpRequest;return b.open("GET",a,!1),b.send(),b},numeric.imageURL=function(a){function b(a){var b,c,d,e,f,g,h,i,j=a.length,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="";for(b=0;b<j;b+=3)c=a[b],d=a[b+1],e=a[b+2],f=c>>2,g=((3&c)<<4)+(d>>4),h=((15&d)<<2)+(e>>6),i=63&e,b+1>=j?h=i=64:b+2>=j&&(i=64),l+=k.charAt(f)+k.charAt(g)+k.charAt(h)+k.charAt(i);return l}function c(a,b,c){void 0===b&&(b=0),void 0===c&&(c=a.length);var d,e=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],f=-1,g=0;a.length;for(d=b;d<c;d++)g=255&(f^a[d]),f=f>>>8^e[g];return-1^f}var d,e,f,g,h,i,j,k,l,m,n=a[0].length,o=a[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,o>>24&255,o>>16&255,o>>8&255,255&o,n>>24&255,n>>16&255,n>>8&255,255&n,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(m=c(p,12,29),p[29]=m>>24&255,p[30]=m>>16&255,p[31]=m>>8&255,p[32]=255&m,d=1,e=0,j=0;j<n;j++){for(j<n-1?p.push(0):p.push(1),h=3*o+1+(0===j)&255,i=3*o+1+(0===j)>>8&255,p.push(h),p.push(i),p.push(255&~h),p.push(255&~i),0===j&&p.push(0),k=0;k<o;k++)for(f=0;f<3;f++)h=a[f][j][k],h=h>255?255:h<0?0:Math.round(h),d=(d+h)%65521,e=(e+d)%65521,p.push(h);p.push(0)}return l=(e<<16)+d,p.push(l>>24&255),p.push(l>>16&255),p.push(l>>8&255),p.push(255&l),g=p.length-41,p[33]=g>>24&255,p[34]=g>>16&255,p[35]=g>>8&255,p[36]=255&g,m=c(p,37),p.push(m>>24&255),p.push(m>>16&255),p.push(m>>8&255),p.push(255&m),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+b(p)},numeric._dim=function(a){for(var b=[];"object"===(void 0===a?"undefined":_typeof(a));)b.push(a.length),a=a[0];return b},numeric.dim=function(a){var b,c;return"object"===(void 0===a?"undefined":_typeof(a))?(b=a[0],"object"===(void 0===b?"undefined":_typeof(b))?(c=b[0],"object"===(void 0===c?"undefined":_typeof(c))?numeric._dim(a):[a.length,b.length]):[a.length]):[]},numeric.mapreduce=function(a,b){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+b+';\nif(typeof x === "number") { var xi = x; '+a+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+a+";\n    xi = x[i-1];\n    "+a+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+a+"\n}\nreturn accum;")},numeric.mapreduce2=function(a,b){return Function("x","var n = x.length;\nvar i,xi;\n"+b+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+a+";\n}\nreturn accum;")},numeric.same=function a(b,c){var d,e;if(!(b instanceof Array&&c instanceof Array))return!1;if((e=b.length)!==c.length)return!1;for(d=0;d<e;d++)if(b[d]!==c[d]){if("object"!==_typeof(b[d]))return!1;if(!a(b[d],c[d]))return!1}return!0},numeric.rep=function(a,b,c){void 0===c&&(c=0);var d,e=a[c],f=Array(e);if(c===a.length-1){for(d=e-2;d>=0;d-=2)f[d+1]=b,f[d]=b;return-1===d&&(f[0]=b),f}for(d=e-1;d>=0;d--)f[d]=numeric.rep(a,b,c+1);return f},numeric.dotMMsmall=function(a,b){var c,d,e,f,g,h,i,j,k,l,m;for(f=a.length,g=b.length,h=b[0].length,i=Array(f),c=f-1;c>=0;c--){for(j=Array(h),k=a[c],e=h-1;e>=0;e--){for(l=k[g-1]*b[g-1][e],d=g-2;d>=1;d-=2)m=d-1,l+=k[d]*b[d][e]+k[m]*b[m][e];0===d&&(l+=k[0]*b[0][e]),j[e]=l}i[c]=j}return i},numeric._getCol=function(a,b,c){var d,e=a.length;for(d=e-1;d>0;--d)c[d]=a[d][b],--d,c[d]=a[d][b];0===d&&(c[0]=a[0][b])},numeric.dotMMbig=function(a,b){var c,d,e,f=numeric._getCol,g=b.length,h=Array(g),i=a.length,j=b[0].length,k=new Array(i),l=numeric.dotVV;for(--g,--i,d=i;-1!==d;--d)k[d]=Array(j);for(--j,d=j;-1!==d;--d)for(f(b,d,h),e=i;-1!==e;--e)0,c=a[e],k[e][d]=l(c,h);return k},numeric.dotMV=function(a,b){var c,d=a.length,e=(b.length,Array(d)),f=numeric.dotVV;for(c=d-1;c>=0;c--)e[c]=f(a[c],b);return e},numeric.dotVM=function(a,b){var c,d,e,f,g,h,i;for(e=a.length,f=b[0].length,g=Array(f),d=f-1;d>=0;d--){for(h=a[e-1]*b[e-1][d],c=e-2;c>=1;c-=2)i=c-1,h+=a[c]*b[c][d]+a[i]*b[i][d];0===c&&(h+=a[0]*b[0][d]),g[d]=h}return g},numeric.dotVV=function(a,b){var c,d,e=a.length,f=a[e-1]*b[e-1];for(c=e-2;c>=1;c-=2)d=c-1,f+=a[c]*b[c]+a[d]*b[d];return 0===c&&(f+=a[0]*b[0]),f},numeric.dot=function(a,b){var c=numeric.dim;switch(1e3*c(a).length+c(b).length){case 2002:return b.length<10?numeric.dotMMsmall(a,b):numeric.dotMMbig(a,b);case 2001:return numeric.dotMV(a,b);case 1002:return numeric.dotVM(a,b);case 1001:return numeric.dotVV(a,b);case 1e3:return numeric.mulVS(a,b);case 1:return numeric.mulSV(a,b);case 0:return a*b;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(a){var b,c,d,e,f=a.length,g=Array(f);for(b=f-1;b>=0;b--){for(e=Array(f),c=b+2,d=f-1;d>=c;d-=2)e[d]=0,e[d-1]=0;for(d>b&&(e[d]=0),e[b]=a[b],d=b-1;d>=1;d-=2)e[d]=0,e[d-1]=0;0===d&&(e[0]=0),g[b]=e}return g},numeric.getDiag=function(a){var b,c=Math.min(a.length,a[0].length),d=Array(c);for(b=c-1;b>=1;--b)d[b]=a[b][b],--b,d[b]=a[b][b];return 0===b&&(d[0]=a[0][0]),d},numeric.identity=function(a){return numeric.diag(numeric.rep([a],1))},numeric.pointwise=function(a,b,c){void 0===c&&(c="");var d,e,f=[],g=/\[i\]$/,h="",i=!1;for(d=0;d<a.length;d++)g.test(a[d])?(e=a[d].substring(0,a[d].length-3),h=e):e=a[d],"ret"===e&&(i=!0),f.push(e);return f[a.length]="_s",f[a.length+1]="_k",f[a.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+h+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(i?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+a.join(",")+",_s,_k+1);\n    return ret;\n}\n"+c+"\nfor(i=_n-1;i!==-1;--i) {\n    "+b+"\n}\nreturn ret;",Function.apply(null,f)},numeric.pointwise2=function(a,b,c){void 0===c&&(c="");var d,e,f=[],g=/\[i\]$/,h="",i=!1;for(d=0;d<a.length;d++)g.test(a[d])?(e=a[d].substring(0,a[d].length-3),h=e):e=a[d],"ret"===e&&(i=!0),f.push(e);return f[a.length]="var _n = "+h+".length;\nvar i"+(i?"":", ret = Array(_n)")+";\n"+c+"\nfor(i=_n-1;i!==-1;--i) {\n"+b+"\n}\nreturn ret;",Function.apply(null,f)},numeric._biforeach=function a(b,c,d,e,f){if(e===d.length-1)return void f(b,c);var g,h=d[e];for(g=h-1;g>=0;g--)a("object"===(void 0===b?"undefined":_typeof(b))?b[g]:b,"object"===(void 0===c?"undefined":_typeof(c))?c[g]:c,d,e+1,f)},numeric._biforeach2=function a(b,c,d,e,f){if(e===d.length-1)return f(b,c);var g,h=d[e],i=Array(h);for(g=h-1;g>=0;--g)i[g]=a("object"===(void 0===b?"undefined":_typeof(b))?b[g]:b,"object"===(void 0===c?"undefined":_typeof(c))?c[g]:c,d,e+1,f);return i},numeric._foreach=function a(b,c,d,e){if(d===c.length-1)return void e(b);var f,g=c[d];for(f=g-1;f>=0;f--)a(b[f],c,d+1,e)},numeric._foreach2=function a(b,c,d,e){if(d===c.length-1)return e(b);var f,g=c[d],h=Array(g);for(f=g-1;f>=0;f--)h[f]=a(b[f],c,d+1,e);return h},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var a,b;for(a=0;a<numeric.mathfuns2.length;++a)b=numeric.mathfuns2[a],numeric.ops2[b]=b;for(a in numeric.ops2)if(numeric.ops2.hasOwnProperty(a)){b=numeric.ops2[a];var c,d,e="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,a)?(e="var "+b+" = Math."+b+";\n",c=function(a,c,d){return a+" = "+b+"("+c+","+d+")"},d=function(a,c){return a+" = "+b+"("+a+","+c+")"}):(c=function(a,c,d){return a+" = "+c+" "+b+" "+d},d=numeric.opseq.hasOwnProperty(a+"eq")?function(a,c){return a+" "+b+"= "+c}:function(a,c){return a+" = "+a+" "+b+" "+c}),numeric[a+"VV"]=numeric.pointwise2(["x[i]","y[i]"],c("ret[i]","x[i]","y[i]"),e),numeric[a+"SV"]=numeric.pointwise2(["x","y[i]"],c("ret[i]","x","y[i]"),e),numeric[a+"VS"]=numeric.pointwise2(["x[i]","y"],c("ret[i]","x[i]","y"),e),numeric[a]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+a+"VV, VS = numeric."+a+"VS, SV = numeric."+a+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+d("x","y")+"\n}\nreturn x;\n"),numeric[b]=numeric[a],numeric[a+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],d("ret[i]","x[i]"),e),numeric[a+"eqS"]=numeric.pointwise2(["ret[i]","x"],d("ret[i]","x"),e),numeric[a+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+a+"eqV, S = numeric."+a+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(a=0;a<numeric.mathfuns2.length;++a)b=numeric.mathfuns2[a],delete numeric.ops2[b];for(a=0;a<numeric.mathfuns.length;++a)b=numeric.mathfuns[a],numeric.ops1[b]=b;for(a in numeric.ops1)numeric.ops1.hasOwnProperty(a)&&(e="",b=numeric.ops1[a],-1!==numeric.myIndexOf.call(numeric.mathfuns,a)&&Math.hasOwnProperty(b)&&(e="var "+b+" = Math."+b+";\n"),numeric[a+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+b+"(ret[i]);",e),numeric[a+"eq"]=Function("x",'if(typeof x !== "object") return '+b+"x\nvar i;\nvar V = numeric."+a+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[a+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+b+"(x[i]);",e),numeric[a]=Function("x",'if(typeof x !== "object") return '+b+"(x)\nvar i;\nvar V = numeric."+a+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(a=0;a<numeric.mathfuns.length;++a)b=numeric.mathfuns[a],delete numeric.ops1[b];for(a in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(a)&&(b=numeric.mapreducers[a],numeric[a+"V"]=numeric.mapreduce2(b[0],b[1]),numeric[a]=Function("x","s","k",b[1]+'if(typeof x !== "object") {    xi = x;\n'+b[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+a+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+b[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(a,b){return"object"===(void 0===a?"undefined":_typeof(a))?"object"===(void 0===b?"undefined":_typeof(b))?numeric.truncVV(a,b):numeric.truncVS(a,b):"object"===(void 0===b?"undefined":_typeof(b))?numeric.truncSV(a,b):Math.round(a/b)*b},numeric.inv=function(a){var b,c,d,e,f,g,h,a,i=numeric.dim(a),j=Math.abs,k=i[0],l=i[1],m=numeric.clone(a),n=numeric.identity(k);for(g=0;g<l;++g){var o=-1,p=-1;for(f=g;f!==k;++f)(h=j(m[f][g]))>p&&(o=f,p=h);for(c=m[o],m[o]=m[g],m[g]=c,e=n[o],n[o]=n[g],n[g]=e,a=c[g],h=g;h!==l;++h)c[h]/=a;for(h=l-1;-1!==h;--h)e[h]/=a;for(f=k-1;-1!==f;--f)if(f!==g){for(b=m[f],d=n[f],a=b[g],h=g+1;h!==l;++h)b[h]-=c[h]*a;for(h=l-1;h>0;--h)d[h]-=e[h]*a,--h,d[h]-=e[h]*a;0===h&&(d[0]-=e[0]*a)}}return n},numeric.det=function(a){var b=numeric.dim(a);if(2!==b.length||b[0]!==b[1])throw new Error("numeric: det() only works on square matrices");var c,d,e,f,g,h,i,j,k=b[0],l=1,m=numeric.clone(a);for(d=0;d<k-1;d++){for(e=d,c=d+1;c<k;c++)Math.abs(m[c][d])>Math.abs(m[e][d])&&(e=c);for(e!==d&&(i=m[e],m[e]=m[d],m[d]=i,l*=-1),f=m[d],c=d+1;c<k;c++){for(g=m[c],h=g[d]/f[d],e=d+1;e<k-1;e+=2)j=e+1,g[e]-=f[e]*h,g[j]-=f[j]*h;e!==k&&(g[e]-=f[e]*h)}if(0===f[d])return 0;l*=f[d]}return l*m[d][d]},numeric.transpose=function(a){var b,c,d,e,f,g=a.length,h=a[0].length,i=Array(h);for(c=0;c<h;c++)i[c]=Array(g);for(b=g-1;b>=1;b-=2){for(e=a[b],d=a[b-1],c=h-1;c>=1;--c)f=i[c],f[b]=e[c],f[b-1]=d[c],--c,f=i[c],f[b]=e[c],f[b-1]=d[c];0===c&&(f=i[0],f[b]=e[0],f[b-1]=d[0])}if(0===b){for(d=a[0],c=h-1;c>=1;--c)i[c][0]=d[c],--c,i[c][0]=d[c];0===c&&(i[0][0]=d[0])}return i},numeric.negtranspose=function(a){var b,c,d,e,f,g=a.length,h=a[0].length,i=Array(h);for(c=0;c<h;c++)i[c]=Array(g);for(b=g-1;b>=1;b-=2){for(e=a[b],d=a[b-1],c=h-1;c>=1;--c)f=i[c],f[b]=-e[c],f[b-1]=-d[c],--c,f=i[c],f[b]=-e[c],f[b-1]=-d[c];0===c&&(f=i[0],f[b]=-e[0],f[b-1]=-d[0])}if(0===b){for(d=a[0],c=h-1;c>=1;--c)i[c][0]=-d[c],--c,i[c][0]=-d[c];0===c&&(i[0][0]=-d[0])}return i},numeric._random=function a(b,c){var d,e,f=b[c],g=Array(f);if(c===b.length-1){for(e=Math.random,d=f-1;d>=1;d-=2)g[d]=e(),g[d-1]=e();return 0===d&&(g[0]=e()),g}for(d=f-1;d>=0;d--)g[d]=a(b,c+1);return g},numeric.random=function(a){return numeric._random(a,0)},numeric.norm2=function(a){return Math.sqrt(numeric.norm2Squared(a))},numeric.linspace=function(a,b,c){if(void 0===c&&(c=Math.max(Math.round(b-a)+1,1)),c<2)return 1===c?[a]:[];var d,e=Array(c);for(c--,d=c;d>=0;d--)e[d]=(d*b+(c-d)*a)/c;return e},numeric.getBlock=function(a,b,c){function d(a,f){var g,h=b[f],i=c[f]-h,j=Array(i);if(f===e.length-1){for(g=i;g>=0;g--)j[g]=a[g+h];return j}for(g=i;g>=0;g--)j[g]=d(a[g+h],f+1);return j}var e=numeric.dim(a);return d(a,0)},numeric.setBlock=function(a,b,c,d){function e(a,d,g){var h,i=b[g],j=c[g]-i;if(g===f.length-1)for(h=j;h>=0;h--)a[h+i]=d[h];for(h=j;h>=0;h--)e(a[h+i],d[h],g+1)}var f=numeric.dim(a);return e(a,d,0),a},numeric.getRange=function(a,b,c){var d,e,f,g,h=b.length,i=c.length,j=Array(h);for(d=h-1;-1!==d;--d)for(j[d]=Array(i),f=j[d],g=a[b[d]],e=i-1;-1!==e;--e)f[e]=g[c[e]];return j},numeric.blockMatrix=function(a){var b=numeric.dim(a);if(b.length<4)return numeric.blockMatrix([a]);var c,d,e,f,g,h=b[0],i=b[1];for(c=0,d=0,e=0;e<h;++e)c+=a[e][0].length;for(f=0;f<i;++f)d+=a[0][f][0].length;var j=Array(c);for(e=0;e<c;++e)j[e]=Array(d);var k,l,m,n,o,p=0;for(e=0;e<h;++e){for(k=d,f=i-1;-1!==f;--f)for(g=a[e][f],k-=g[0].length,m=g.length-1;-1!==m;--m)for(o=g[m],l=j[p+m],n=o.length-1;-1!==n;--n)l[k+n]=o[n];p+=a[e][0].length}return j},numeric.tensor=function(a,b){if("number"==typeof a||"number"==typeof b)return numeric.mul(a,b);var c=numeric.dim(a),d=numeric.dim(b);if(1!==c.length||1!==d.length)throw new Error("numeric: tensor product is only defined for vectors");var e,f,g,h,i=c[0],j=d[0],k=Array(i);for(f=i-1;f>=0;f--){for(e=Array(j),h=a[f],g=j-1;g>=3;--g)e[g]=h*b[g],--g,e[g]=h*b[g],--g,e[g]=h*b[g],--g,e[g]=h*b[g];for(;g>=0;)e[g]=h*b[g],--g;k[f]=e}return k},numeric.T=function(a,b){this.x=a,this.y=b},numeric.t=function(a,b){return new numeric.T(a,b)},numeric.Tbinop=function(a,b,c,d,e){numeric.indexOf;if("string"!=typeof e){var f;e="";for(f in numeric)numeric.hasOwnProperty(f)&&(a.indexOf(f)>=0||b.indexOf(f)>=0||c.indexOf(f)>=0||d.indexOf(f)>=0)&&f.length>1&&(e+="var "+f+" = numeric."+f+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+e+"\nif(x.y) {  if(y.y) {    return new numeric.T("+d+");\n  }\n  return new numeric.T("+c+");\n}\nif(y.y) {\n  return new numeric.T("+b+");\n}\nreturn new numeric.T("+a+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var a=numeric.mul,b=numeric.div;if(this.y){var c=numeric.add(a(this.x,this.x),a(this.y,this.y));return new numeric.T(b(this.x,c),b(numeric.neg(this.y),c))}return new T(b(1,this.x))},numeric.T.prototype.div=function(a){if(a instanceof numeric.T||(a=new numeric.T(a)),a.y)return this.mul(a.reciprocal());var b=numeric.div;return this.y?new numeric.T(b(this.x,a.x),b(this.y,a.x)):new numeric.T(b(this.x,a.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var a=numeric.transpose,b=this.x,c=this.y;return c?new numeric.T(a(b),a(c)):new numeric.T(a(b))},numeric.T.prototype.transjugate=function(){var a=numeric.transpose,b=this.x,c=this.y;return c?new numeric.T(a(b),numeric.negtranspose(c)):new numeric.T(a(b))},numeric.Tunop=function(a,b,c){return"string"!=typeof c&&(c=""),Function("var x = this;\n"+c+"\nif(x.y) {  "+b+";\n}\n"+a+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var a=this;if(void 0===a.y)return new numeric.T(numeric.inv(a.x));var b,c,d,e,f,g,h,i,j,k,l,b,c,d,m,n,o,p,q,r,s,t=a.x.length,u=numeric.identity(t),v=numeric.rep([t,t],0),w=numeric.clone(a.x),x=numeric.clone(a.y);for(b=0;b<t;b++){for(o=w[b][b],p=x[b][b],m=o*o+p*p,d=b,c=b+1;c<t;c++)o=w[c][b],p=x[c][b],(n=o*o+p*p)>m&&(d=c,m=n);for(d!==b&&(s=w[b],w[b]=w[d],w[d]=s,s=x[b],x[b]=x[d],x[d]=s,s=u[b],u[b]=u[d],u[d]=s,s=v[b],v[b]=v[d],v[d]=s),e=w[b],f=x[b],i=u[b],j=v[b],o=e[b],p=f[b],c=b+1;c<t;c++)q=e[c],r=f[c],e[c]=(q*o+r*p)/m,f[c]=(r*o-q*p)/m;for(c=0;c<t;c++)q=i[c],r=j[c],i[c]=(q*o+r*p)/m,j[c]=(r*o-q*p)/m;for(c=b+1;c<t;c++){for(g=w[c],h=x[c],k=u[c],l=v[c],o=g[b],p=h[b],d=b+1;d<t;d++)q=e[d],r=f[d],g[d]-=q*o-r*p,h[d]-=r*o+q*p;for(d=0;d<t;d++)q=i[d],r=j[d],k[d]-=q*o-r*p,l[d]-=r*o+q*p}}for(b=t-1;b>0;b--)for(i=u[b],j=v[b],c=b-1;c>=0;c--)for(k=u[c],l=v[c],o=w[c][b],p=x[c][b],d=t-1;d>=0;d--)q=i[d],r=j[d],k[d]-=o*q-p*r,l[d]-=o*r+p*q;return new numeric.T(u,v)},numeric.T.prototype.get=function(a){var b,c=this.x,d=this.y,e=0,f=a.length;if(d){for(;e<f;)b=a[e],c=c[b],d=d[b],e++;return new numeric.T(c,d)}for(;e<f;)b=a[e],c=c[b],e++;return new numeric.T(c)},numeric.T.prototype.set=function(a,b){var c,d=this.x,e=this.y,f=0,g=a.length,h=b.x,i=b.y;if(0===g)return i?this.y=i:e&&(this.y=void 0),this.x=d,this;if(i){for(e||(e=numeric.rep(numeric.dim(d),0),this.y=e);f<g-1;)c=a[f],d=d[c],e=e[c],f++;return c=a[f],d[c]=h,e[c]=i,this}if(e){for(;f<g-1;)c=a[f],d=d[c],e=e[c],f++;return c=a[f],d[c]=h,h instanceof Array?e[c]=numeric.rep(numeric.dim(h),0):e[c]=0,this}for(;f<g-1;)c=a[f],d=d[c],f++;return c=a[f],d[c]=h,this},numeric.T.prototype.getRows=function(a,b){var c,d,e=b-a+1,f=Array(e),g=this.x,h=this.y;for(c=a;c<=b;c++)f[c-a]=g[c];if(h){for(d=Array(e),c=a;c<=b;c++)d[c-a]=h[c];return new numeric.T(f,d)}return new numeric.T(f)},numeric.T.prototype.setRows=function(a,b,c){var d,e=this.x,f=this.y,g=c.x,h=c.y;for(d=a;d<=b;d++)e[d]=g[d-a];if(h)for(f||(f=numeric.rep(numeric.dim(e),0),this.y=f),d=a;d<=b;d++)f[d]=h[d-a];else if(f)for(d=a;d<=b;d++)f[d]=numeric.rep([g[d-a].length],0);return this},numeric.T.prototype.getRow=function(a){var b=this.x,c=this.y;return c?new numeric.T(b[a],c[a]):new numeric.T(b[a])},numeric.T.prototype.setRow=function(a,b){var c=this.x,d=this.y,e=b.x,f=b.y;return c[a]=e,f?(d||(d=numeric.rep(numeric.dim(c),0),this.y=d),d[a]=f):d&&(d=numeric.rep([e.length],0)),this},numeric.T.prototype.getBlock=function(a,b){var c=this.x,d=this.y,e=numeric.getBlock;return d?new numeric.T(e(c,a,b),e(d,a,b)):new numeric.T(e(c,a,b))},numeric.T.prototype.setBlock=function(a,b,c){c instanceof numeric.T||(c=new numeric.T(c));var d=this.x,e=this.y,f=numeric.setBlock,g=c.x,h=c.y;if(h)return e||(this.y=numeric.rep(numeric.dim(this),0),e=this.y),f(d,a,b,g),f(e,a,b,h),this;f(d,a,b,g),e&&f(e,a,b,numeric.rep(numeric.dim(g),0))},numeric.T.rep=function(a,b){var c=numeric.T;b instanceof c||(b=new c(b));var d=b.x,e=b.y,f=numeric.rep;return e?new c(f(a,d),f(a,e)):new c(f(a,d))},numeric.T.diag=function(a){a instanceof numeric.T||(a=new numeric.T(a));var b=a.x,c=a.y,d=numeric.diag;return c?new numeric.T(d(b),d(c)):new numeric.T(d(b))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(a){return new numeric.T(numeric.identity(a))},numeric.T.prototype.getDiag=function(){var a=numeric,b=this.x,c=this.y;return c?new a.T(a.getDiag(b),a.getDiag(c)):new a.T(a.getDiag(b))},numeric.house=function(a){var b=numeric.clone(a),c=a[0]>=0?1:-1,d=c*numeric.norm2(a);b[0]+=d;var e=numeric.norm2(b);if(0===e)throw new Error("eig: internal error");return numeric.div(b,e)},numeric.toUpperHessenberg=function(a){var b=numeric.dim(a);if(2!==b.length||b[0]!==b[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var c,d,e,f,g,h,i,j,k,l,m=b[0],n=numeric.clone(a),o=numeric.identity(m);for(d=0;d<m-2;d++){for(f=Array(m-d-1),c=d+1;c<m;c++)f[c-d-1]=n[c][d];if(numeric.norm2(f)>0){for(g=numeric.house(f),h=numeric.getBlock(n,[d+1,d],[m-1,m-1]),i=numeric.tensor(g,numeric.dot(g,h)),c=d+1;c<m;c++)for(j=n[c],k=i[c-d-1],e=d;e<m;e++)j[e]-=2*k[e-d];for(h=numeric.getBlock(n,[0,d+1],[m-1,m-1]),i=numeric.tensor(numeric.dot(h,g),g),c=0;c<m;c++)for(j=n[c],k=i[c],e=d+1;e<m;e++)j[e]-=2*k[e-d-1];for(h=Array(m-d-1),c=d+1;c<m;c++)h[c-d-1]=o[c];for(i=numeric.tensor(g,numeric.dot(g,h)),c=d+1;c<m;c++)for(l=o[c],k=i[c-d-1],e=0;e<m;e++)l[e]-=2*k[e]}}return{H:n,Q:o}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(a,b){void 0===b&&(b=1e4),a=numeric.clone(a);var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=(numeric.clone(a),numeric.dim(a)),v=u[0],w=numeric.identity(v);if(v<3)return{Q:w,B:[[0,v-1]]};var x=numeric.epsilon;for(t=0;t<b;t++){for(r=0;r<v-1;r++)if(Math.abs(a[r+1][r])<x*(Math.abs(a[r][r])+Math.abs(a[r+1][r+1]))){var y=numeric.QRFrancis(numeric.getBlock(a,[0,0],[r,r]),b),z=numeric.QRFrancis(numeric.getBlock(a,[r+1,r+1],[v-1,v-1]),b);for(n=Array(r+1),q=0;q<=r;q++)n[q]=w[q];for(o=numeric.dot(y.Q,n),q=0;q<=r;q++)w[q]=o[q];for(n=Array(v-r-1),q=r+1;q<v;q++)n[q-r-1]=w[q];for(o=numeric.dot(z.Q,n),q=r+1;q<v;q++)w[q]=o[q-r-1];return{Q:w,B:y.B.concat(numeric.add(z.B,r+1))}}if(e=a[v-2][v-2],f=a[v-2][v-1],g=a[v-1][v-2],h=a[v-1][v-1],j=e+h,i=e*h-f*g,k=numeric.getBlock(a,[0,0],[2,2]),j*j>=4*i){var A,B;A=.5*(j+Math.sqrt(j*j-4*i)),B=.5*(j-Math.sqrt(j*j-4*i)),k=numeric.add(numeric.sub(numeric.dot(k,k),numeric.mul(k,A+B)),numeric.diag(numeric.rep([3],A*B)))}else k=numeric.add(numeric.sub(numeric.dot(k,k),numeric.mul(k,j)),numeric.diag(numeric.rep([3],i)));for(c=[k[0][0],k[1][0],k[2][0]],d=numeric.house(c),n=[a[0],a[1],a[2]],o=numeric.tensor(d,numeric.dot(d,n)),q=0;q<3;q++)for(m=a[q],p=o[q],s=0;s<v;s++)m[s]-=2*p[s];for(n=numeric.getBlock(a,[0,0],[v-1,2]),o=numeric.tensor(numeric.dot(n,d),d),q=0;q<v;q++)for(m=a[q],p=o[q],s=0;s<3;s++)m[s]-=2*p[s];for(n=[w[0],w[1],w[2]],o=numeric.tensor(d,numeric.dot(d,n)),q=0;q<3;q++)for(l=w[q],p=o[q],s=0;s<v;s++)l[s]-=2*p[s];var C;for(r=0;r<v-2;r++){for(s=r;s<=r+1;s++)if(Math.abs(a[s+1][s])<x*(Math.abs(a[s][s])+Math.abs(a[s+1][s+1]))){var y=numeric.QRFrancis(numeric.getBlock(a,[0,0],[s,s]),b),z=numeric.QRFrancis(numeric.getBlock(a,[s+1,s+1],[v-1,v-1]),b);for(n=Array(s+1),q=0;q<=s;q++)n[q]=w[q];for(o=numeric.dot(y.Q,n),q=0;q<=s;q++)w[q]=o[q];for(n=Array(v-s-1),q=s+1;q<v;q++)n[q-s-1]=w[q];for(o=numeric.dot(z.Q,n),q=s+1;q<v;q++)w[q]=o[q-s-1];return{Q:w,B:y.B.concat(numeric.add(z.B,s+1))}}for(C=Math.min(v-1,r+3),c=Array(C-r),q=r+1;q<=C;q++)c[q-r-1]=a[q][r];for(d=numeric.house(c),n=numeric.getBlock(a,[r+1,r],[C,v-1]),o=numeric.tensor(d,numeric.dot(d,n)),q=r+1;q<=C;q++)for(m=a[q],p=o[q-r-1],s=r;s<v;s++)m[s]-=2*p[s-r];for(n=numeric.getBlock(a,[0,r+1],[v-1,C]),o=numeric.tensor(numeric.dot(n,d),d),q=0;q<v;q++)for(m=a[q],p=o[q],s=r+1;s<=C;s++)m[s]-=2*p[s-r-1];for(n=Array(C-r),q=r+1;q<=C;q++)n[q-r-1]=w[q];for(o=numeric.tensor(d,numeric.dot(d,n)),q=r+1;q<=C;q++)for(l=w[q],p=o[q-r-1],s=0;s<v;s++)l[s]-=2*p[s]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=numeric.toUpperHessenberg(a),u=numeric.QRFrancis(t.H,b),v=numeric.T,w=a.length,x=u.B,y=numeric.dot(u.Q,numeric.dot(t.H,numeric.transpose(u.Q))),z=new v(numeric.dot(u.Q,t.Q)),A=x.length,B=Math.sqrt;for(d=0;d<A;d++)if((c=x[d][0])===x[d][1]);else{if(f=c+1,g=y[c][c],h=y[c][f],i=y[f][c],j=y[f][f],0===h&&0===i)continue;k=-g-j,l=g*j-h*i,m=k*k-4*l,m>=0?(n=k<0?-.5*(k-B(m)):-.5*(k+B(m)),r=(g-n)*(g-n)+h*h,s=i*i+(j-n)*(j-n),r>s?(r=B(r),p=(g-n)/r,q=h/r):(s=B(s),p=i/s,q=(j-n)/s),e=new v([[q,-p],[p,q]]),z.setRows(c,f,e.dot(z.getRows(c,f)))):(n=-.5*k,o=.5*B(-m),r=(g-n)*(g-n)+h*h,s=i*i+(j-n)*(j-n),r>s?(r=B(r+o*o),p=(g-n)/r,q=h/r,n=0,o/=r):(s=B(s+o*o),p=i/s,q=(j-n)/s,n=o/s,o=0),e=new v([[q,-p],[p,q]],[[n,o],[o,-n]]),z.setRows(c,f,e.dot(z.getRows(c,f))))}var C=z.dot(a).dot(z.transjugate()),w=a.length,D=numeric.T.identity(w);for(f=0;f<w;f++)if(f>0)for(d=f-1;d>=0;d--){var E=C.get([d,d]),F=C.get([f,f]);numeric.neq(E.x,F.x)||numeric.neq(E.y,F.y)?(n=C.getRow(d).getBlock([d],[f-1]),o=D.getRow(f).getBlock([d],[f-1]),D.set([f,d],C.get([d,f]).neg().sub(n.dot(o)).div(E.sub(F)))):D.setRow(f,D.getRow(d))}for(f=0;f<w;f++)n=D.getRow(f),D.setRow(f,n.div(n.norm2()));return D=D.transpose(),D=z.transjugate().dot(D),{lambda:C.getDiag(),E:D}},numeric.ccsSparse=function(a){var b,c,d,e,f=a.length,g=[];for(d=f-1;-1!==d;--d){c=a[d];for(e in c){for(e=parseInt(e);e>=g.length;)g[g.length]=0;0!==c[e]&&g[e]++}}var b=g.length,h=Array(b+1);for(h[0]=0,d=0;d<b;++d)h[d+1]=h[d]+g[d];var i=Array(h[b]),j=Array(h[b]);for(d=f-1;-1!==d;--d){c=a[d];for(e in c)0!==c[e]&&(g[e]--,i[h[e]+g[e]]=d,j[h[e]+g[e]]=c[e])}return[h,i,j]},numeric.ccsFull=function(a){var b,c,d,e,f=a[0],g=a[1],h=a[2],i=numeric.ccsDim(a),j=i[0],k=i[1],l=numeric.rep([j,k],0);for(b=0;b<k;b++)for(d=f[b],e=f[b+1],c=d;c<e;++c)l[g[c]][b]=h[c];return l},numeric.ccsTSolve=function(a,b,c,d,e){function f(a){var b;if(0===c[a]){for(c[a]=1,b=g[a];b<g[a+1];++b)f(h[b]);e[l]=a,++l}}var g=a[0],h=a[1],i=a[2],j=g.length-1,k=Math.max,l=0;void 0===d&&(c=numeric.rep([j],0)),void 0===d&&(d=numeric.linspace(0,c.length-1)),void 0===e&&(e=[]);var m,n,o,p,q,r,s;for(m=d.length-1;-1!==m;--m)f(d[m]);for(e.length=l,m=e.length-1;-1!==m;--m)c[e[m]]=0;for(m=d.length-1;-1!==m;--m)n=d[m],c[n]=b[n];for(m=e.length-1;-1!==m;--m){for(n=e[m],o=g[n],p=k(g[n+1],o),q=o;q!==p;++q)if(h[q]===n){c[n]/=i[q];break}for(s=c[n],q=o;q!==p;++q)(r=h[q])!==n&&(c[r]-=s*i[q])}return c},numeric.ccsDFS=function(a){this.k=Array(a),this.k1=Array(a),this.j=Array(a)},numeric.ccsDFS.prototype.dfs=function(a,b,c,d,e,f){var g,h,i,j=0,k=e.length,l=this.k,m=this.k1,n=this.j;if(0===d[a])for(d[a]=1,n[0]=a,l[0]=h=b[a],m[0]=i=b[a+1];;)if(h>=i){if(e[k]=n[j],0===j)return;++k,--j,h=l[j],i=m[j]}else g=f[c[h]],0===d[g]?(d[g]=1,l[j]=h,++j,n[j]=g,h=b[g],m[j]=i=b[g+1]):++h},numeric.ccsLPSolve=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q=a[0],r=a[1],s=a[2],t=(q.length,b[0]),u=b[1],v=b[2];for(i=t[e],j=t[e+1],d.length=0,h=i;h<j;++h)g.dfs(f[u[h]],q,r,c,d,f);for(h=d.length-1;-1!==h;--h)c[d[h]]=0;for(h=i;h!==j;++h)k=f[u[h]],c[k]=v[h];for(h=d.length-1;-1!==h;--h){for(k=d[h],l=q[k],m=q[k+1],n=l;n<m;++n)if(f[r[n]]===k){c[k]/=s[n];break}for(p=c[k],n=l;n<m;++n)(o=f[r[n]])!==k&&(c[o]-=p*s[n])}return c},numeric.ccsLUP1=function(a,b){var c,d,e,f,g,h,i,j=a[0].length-1,k=[numeric.rep([j+1],0),[],[]],l=[numeric.rep([j+1],0),[],[]],m=k[0],n=k[1],o=k[2],p=l[0],q=l[1],r=l[2],s=numeric.rep([j],0),t=numeric.rep([j],0),u=numeric.ccsLPSolve,v=(Math.max,Math.abs),w=numeric.linspace(0,j-1),x=numeric.linspace(0,j-1),y=new numeric.ccsDFS(j);for(void 0===b&&(b=1),c=0;c<j;++c){for(u(k,a,s,t,c,x,y),f=-1,g=-1,d=t.length-1;-1!==d;--d)(e=t[d])<=c||(h=v(s[e]))>f&&(g=e,f=h);for(v(s[c])<b*f&&(d=w[c],f=w[g],w[c]=f,x[f]=c,w[g]=d,x[d]=g,f=s[c],s[c]=s[g],s[g]=f),f=m[c],g=p[c],i=s[c],n[f]=w[c],o[f]=1,++f,d=t.length-1;-1!==d;--d)e=t[d],h=s[e],t[d]=0,s[e]=0,e<=c?(q[g]=e,r[g]=h,++g):(n[f]=w[e],o[f]=h/i,++f);m[c+1]=f,p[c+1]=g}for(d=n.length-1;-1!==d;--d)n[d]=x[n[d]];return{L:k,U:l,P:w,Pinv:x}},numeric.ccsDFS0=function(a){this.k=Array(a),this.k1=Array(a),this.j=Array(a)},numeric.ccsDFS0.prototype.dfs=function(a,b,c,d,e,f,g){var h,i,j,k=0,l=e.length,m=this.k,n=this.k1,o=this.j;if(0===d[a])for(d[a]=1,o[0]=a,m[0]=i=b[f[a]],n[0]=j=b[f[a]+1];;){if(isNaN(i))throw new Error("Ow!");if(i>=j){if(e[l]=f[o[k]],0===k)return;++l,--k,i=m[k],j=n[k]}else h=c[i],0===d[h]?(d[h]=1,m[k]=i,++k,o[k]=h,h=f[h],i=b[h],n[k]=j=b[h+1]):++i}},numeric.ccsLPSolve0=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r=a[0],s=a[1],t=a[2],u=(r.length,b[0]),v=b[1],w=b[2];for(j=u[e],k=u[e+1],d.length=0,i=j;i<k;++i)h.dfs(v[i],r,s,c,d,f,g);for(i=d.length-1;-1!==i;--i)l=d[i],c[g[l]]=0;for(i=j;i!==k;++i)l=v[i],c[l]=w[i];for(i=d.length-1;-1!==i;--i){for(l=d[i],p=g[l],m=r[l],n=r[l+1],o=m;o<n;++o)if(s[o]===p){c[p]/=t[o];break}for(q=c[p],o=m;o<n;++o)c[s[o]]-=q*t[o];c[p]=q}},numeric.ccsLUP0=function(a,b){var c,d,e,f,g,h,i,j=a[0].length-1,k=[numeric.rep([j+1],0),[],[]],l=[numeric.rep([j+1],0),[],[]],m=k[0],n=k[1],o=k[2],p=l[0],q=l[1],r=l[2],s=numeric.rep([j],0),t=numeric.rep([j],0),u=numeric.ccsLPSolve0,v=(Math.max,Math.abs),w=numeric.linspace(0,j-1),x=numeric.linspace(0,j-1),y=new numeric.ccsDFS0(j);for(void 0===b&&(b=1),c=0;c<j;++c){for(u(k,a,s,t,c,x,w,y),f=-1,g=-1,d=t.length-1;-1!==d;--d)(e=t[d])<=c||(h=v(s[w[e]]))>f&&(g=e,f=h);for(v(s[w[c]])<b*f&&(d=w[c],f=w[g],w[c]=f,x[f]=c,w[g]=d,x[d]=g),f=m[c],g=p[c],i=s[w[c]],n[f]=w[c],o[f]=1,++f,d=t.length-1;-1!==d;--d)e=t[d],h=s[w[e]],t[d]=0,s[w[e]]=0,e<=c?(q[g]=e,r[g]=h,++g):(n[f]=w[e],o[f]=h/i,++f);m[c+1]=f,p[c+1]=g}for(d=n.length-1;-1!==d;--d)n[d]=x[n[d]];return{L:k,U:l,P:w,Pinv:x}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(a){return[numeric.sup(a[1])+1,a[0].length-1]},numeric.ccsGetBlock=function(a,b,c){var d=numeric.ccsDim(a),e=d[0],f=d[1];void 0===b?b=numeric.linspace(0,e-1):"number"==typeof b&&(b=[b]),void 0===c?c=numeric.linspace(0,f-1):"number"==typeof c&&(c=[c]);var g,h,i,j,k,l=b.length,m=c.length,n=numeric.rep([f],0),o=[],p=[],q=[n,o,p],r=a[0],s=a[1],t=a[2],u=numeric.rep([e],0),v=0,w=numeric.rep([e],0);for(h=0;h<m;++h){j=c[h];var x=r[j],y=r[j+1];for(g=x;g<y;++g)i=s[g],w[i]=1,u[i]=t[g];for(g=0;g<l;++g)k=b[g],w[k]&&(o[v]=g,p[v]=u[b[g]],++v);for(g=x;g<y;++g)i=s[g],w[i]=0;n[h+1]=v}return q},numeric.ccsDot=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=a[0],o=a[1],p=a[2],q=b[0],r=b[1],s=b[2],t=numeric.ccsDim(a),u=numeric.ccsDim(b),v=t[0],w=(t[1],u[1]),x=numeric.rep([v],0),y=numeric.rep([v],0),z=Array(v),A=numeric.rep([w],0),B=[],C=[],D=[A,B,C];for(e=0;e!==w;++e){for(f=q[e],g=q[e+1],k=0,d=f;d<g;++d)for(l=r[d],m=s[d],h=n[l],i=n[l+1],c=h;c<i;++c)j=o[c],0===y[j]&&(z[k]=j,y[j]=1,k+=1),x[j]=x[j]+p[c]*m;for(f=A[e],g=f+k,A[e+1]=g,d=k-1;-1!==d;--d)m=f+d,c=z[d],B[m]=c,C[m]=x[c],y[c]=0,x[c]=0;A[e+1]=A[e]+k}return D},numeric.ccsLUPSolve=function(a,b){var c=a.L,d=a.U,e=(a.P,b[0]),f=!1;"object"!==(void 0===e?"undefined":_typeof(e))&&(b=[[0,b.length],numeric.linspace(0,b.length-1),b],e=b[0],f=!0);var g,h,i,j,k,l,m=b[1],n=b[2],o=c[0].length-1,p=e.length-1,q=numeric.rep([o],0),r=Array(o),s=numeric.rep([o],0),t=Array(o),u=numeric.rep([p+1],0),v=[],w=[],x=numeric.ccsTSolve,y=0;for(g=0;g<p;++g){for(k=0,i=e[g],j=e[g+1],h=i;h<j;++h)l=a.Pinv[m[h]],t[k]=l,s[l]=n[h],++k;for(t.length=k,x(c,s,q,t,r),h=t.length-1;-1!==h;--h)s[t[h]]=0;if(x(d,q,s,r,t),f)return s;for(h=r.length-1;-1!==h;--h)q[r[h]]=0;for(h=t.length-1;-1!==h;--h)l=t[h],v[y]=l,w[y]=s[l],s[l]=0,++y;u[g+1]=y}return[u,v,w]},numeric.ccsbinop=function(a,b){return void 0===b&&(b=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+b+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+a+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(a){var b,c=a[0],d=a[1],e=a[2],f=numeric.sup(d)+1,g=c.length,h=numeric.rep([f],0),i=Array(g),j=Array(g),k=numeric.rep([f],0);for(b=0;b<g;++b)k[d[b]]++;for(b=0;b<f;++b)h[b+1]=h[b]+k[b];var l,m,n=h.slice(0);for(b=0;b<g;++b)m=d[b],l=n[m],i[l]=c[b],j[l]=e[b],n[m]=n[m]+1;return[h,i,j]},numeric.ccsGather=function(a){var b,c,d,e,f,g=a[0],h=a[1],i=a[2],j=g.length-1,k=h.length,l=Array(k),m=Array(k),n=Array(k);for(f=0,b=0;b<j;++b)for(d=g[b],e=g[b+1],c=d;c!==e;++c)m[f]=b,l[f]=h[c],n[f]=i[c],++f;return[l,m,n]},numeric.sdim=function a(b,c,d){if(void 0===c&&(c=[]),"object"!==(void 0===b?"undefined":_typeof(b)))return c;void 0===d&&(d=0),d in c||(c[d]=0),b.length>c[d]&&(c[d]=b.length);var e;for(e in b)b.hasOwnProperty(e)&&a(b[e],c,d+1);return c},numeric.sclone=function a(b,c,d){void 0===c&&(c=0),void 0===d&&(d=numeric.sdim(b).length);var e,f=Array(b.length);if(c===d-1){for(e in b)b.hasOwnProperty(e)&&(f[e]=b[e]);return f}for(e in b)b.hasOwnProperty(e)&&(f[e]=a(b[e],c+1,d));return f},numeric.sdiag=function(a){var b,c,d=a.length,e=Array(d);for(b=d-1;b>=1;b-=2)c=b-1,e[b]=[],e[b][b]=a[b],e[c]=[],e[c][c]=a[c];return 0===b&&(e[0]=[],e[0][0]=a[b]),e},numeric.sidentity=function(a){return numeric.sdiag(numeric.rep([a],1))},numeric.stranspose=function(a){var b,c,d,e=[];a.length;for(b in a)if(a.hasOwnProperty(b)){d=a[b];for(c in d)d.hasOwnProperty(c)&&("object"!==_typeof(e[c])&&(e[c]=[]),e[c][b]=d[c])}return e},numeric.sLUP=function(a,b){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(a,b){var c,d,e,f,g,h,i,j=a.length,k=(b.length,numeric.stranspose(b)),l=k.length,m=Array(j);for(e=j-1;e>=0;e--){for(i=[],c=a[e],g=l-1;g>=0;g--){h=0,d=k[g];for(f in c)c.hasOwnProperty(f)&&f in d&&(h+=c[f]*d[f]);h&&(i[g]=h)}m[e]=i}return m},numeric.sdotMV=function(a,b){var c,d,e,f,g=a.length,h=Array(g);for(d=g-1;d>=0;d--){c=a[d],f=0;for(e in c)c.hasOwnProperty(e)&&b[e]&&(f+=c[e]*b[e]);f&&(h[d]=f)}return h},numeric.sdotVM=function(a,b){var c,d,e,f,g=[];for(c in a)if(a.hasOwnProperty(c)){e=b[c],f=a[c];for(d in e)e.hasOwnProperty(d)&&(g[d]||(g[d]=0),g[d]+=f*e[d])}return g},numeric.sdotVV=function(a,b){var c,d=0;for(c in a)a[c]&&b[c]&&(d+=a[c]*b[c]);return d},numeric.sdot=function(a,b){var c=numeric.sdim(a).length,d=numeric.sdim(b).length;switch(1e3*c+d){case 0:return a*b;case 1001:return numeric.sdotVV(a,b);case 2001:return numeric.sdotMV(a,b);case 1002:return numeric.sdotVM(a,b);case 2002:return numeric.sdotMM(a,b);default:throw new Error("numeric.sdot not implemented for tensors of order "+c+" and "+d)}},numeric.sscatter=function(a){var b,c,d,e,f=a[0].length,g=a.length,h=[];for(c=f-1;c>=0;--c)if(a[g-1][c]){for(e=h,d=0;d<g-2;d++)b=a[d][c],e[b]||(e[b]=[]),e=e[b];e[a[d][c]]=a[d+1][c]}return h},numeric.sgather=function a(b,c,d){void 0===c&&(c=[]),void 0===d&&(d=[]);var e,f,g;e=d.length;for(f in b)if(b.hasOwnProperty(f))if(d[e]=parseInt(f),"number"==typeof(g=b[f])){if(g){if(0===c.length)for(f=e+1;f>=0;--f)c[f]=[];for(f=e;f>=0;--f)c[f].push(d[f]);c[e+1].push(g)}}else a(g,c,d);return d.length>e&&d.pop(),c},numeric.cLU=function(a){var b,c,d,e,f,g,h=a[0],i=a[1],j=a[2],k=h.length,l=0;for(b=0;b<k;b++)h[b]>l&&(l=h[b]);l++;var m,n,o,p=Array(l),q=Array(l),r=numeric.rep([l],1/0),s=numeric.rep([l],-1/0);for(d=0;d<k;d++)b=h[d],c=i[d],c<r[b]&&(r[b]=c),c>s[b]&&(s[b]=c);for(b=0;b<l-1;b++)s[b]>s[b+1]&&(s[b+1]=s[b]);for(b=l-1;b>=1;b--)r[b]<r[b-1]&&(r[b-1]=r[b]);var t=0,u=0;for(b=0;b<l;b++)q[b]=numeric.rep([s[b]-r[b]+1],0),p[b]=numeric.rep([b-r[b]],0),t+=b-r[b]+1,u+=s[b]-b+1;for(d=0;d<k;d++)b=h[d],q[b][i[d]-r[b]]=j[d];for(b=0;b<l-1;b++)for(e=b-r[b],m=q[b],c=b+1;r[c]<=b&&c<l;c++)if(f=b-r[c],g=s[b]-b,n=q[c],o=n[f]/m[e]){for(d=1;d<=g;d++)n[d+f]-=o*m[d+e];p[c][b-r[c]]=o}var k,v,w,m=[],n=[],x=[],y=[],z=[],A=[];for(k=0,v=0,b=0;b<l;b++){for(e=r[b],f=s[b],w=q[b],c=b;c<=f;c++)w[c-e]&&(m[k]=b,n[k]=c,x[k]=w[c-e],k++);for(w=p[b],c=e;c<b;c++)w[c-e]&&(y[v]=b,z[v]=c,A[v]=w[c-e],v++);y[v]=b,z[v]=b,A[v]=1,v++}return{U:[m,n,x],L:[y,z,A]}},numeric.cLUsolve=function(a,b){var c,d,e=a.L,f=a.U,g=numeric.clone(b),h=e[0],i=e[1],j=e[2],k=f[0],l=f[1],m=f[2],n=k.length,o=(h.length,g.length);for(d=0,c=0;c<o;c++){for(;i[d]<c;)g[c]-=j[d]*g[i[d]],d++;d++}for(d=n-1,c=o-1;c>=0;c--){for(;l[d]>c;)g[c]-=m[d]*g[l[d]],d--;g[c]/=m[d],d--}return g},numeric.cgrid=function(a,b){"number"==typeof a&&(a=[a,a]);var c,d,e,f=numeric.rep(a,-1);if("function"!=typeof b)switch(b){case"L":b=function(b,c){return b>=a[0]/2||c<a[1]/2};break;default:b=function(a,b){return!0}}for(e=0,c=1;c<a[0]-1;c++)for(d=1;d<a[1]-1;d++)b(c,d)&&(f[c][d]=e,e++);return f},numeric.cdelsq=function(a){var b,c,d,e,f,g=[[-1,0],[0,-1],[0,1],[1,0]],h=numeric.dim(a),i=h[0],j=h[1],k=[],l=[],m=[];for(b=1;b<i-1;b++)for(c=1;c<j-1;c++)if(!(a[b][c]<0)){for(d=0;d<4;d++)e=b+g[d][0],f=c+g[d][1],a[e][f]<0||(k.push(a[b][c]),l.push(a[e][f]),m.push(-1));k.push(a[b][c]),l.push(a[b][c]),m.push(4)}return[k,l,m]},numeric.cdotMV=function(a,b){var c,d,e,f=a[0],g=a[1],h=a[2],i=f.length;for(e=0,d=0;d<i;d++)f[d]>e&&(e=f[d]);for(e++,c=numeric.rep([e],0),d=0;d<i;d++)c[f[d]]+=h[d]*b[g[d]];return c},numeric.Spline=function(a,b,c,d,e){this.x=a,this.yl=b,this.yr=c,this.kl=d,this.kr=e},numeric.Spline.prototype._at=function(a,b){var a,c,d,e,f=this.x,g=this.yl,h=this.yr,i=this.kl,j=this.kr,k=numeric.add,l=numeric.sub,m=numeric.mul;c=l(m(i[b],f[b+1]-f[b]),l(h[b+1],g[b])),d=k(m(j[b+1],f[b]-f[b+1]),l(h[b+1],g[b])),e=(a-f[b])/(f[b+1]-f[b]);var n=e*(1-e);return k(k(k(m(1-e,g[b]),m(e,h[b+1])),m(c,n*(1-e))),m(d,n*e))},numeric.Spline.prototype.at=function(a){if("number"==typeof a){var b,c,d,e=this.x,f=e.length,g=Math.floor;for(b=0,c=f-1;c-b>1;)d=g((b+c)/2),e[d]<=a?b=d:c=d;return this._at(a,b)}var h,f=a.length,i=Array(f);for(h=f-1;-1!==h;--h)i[h]=this.at(a[h]);return i},numeric.Spline.prototype.diff=function(){var a,b,c,d=this.x,e=this.yl,f=this.yr,g=this.kl,h=this.kr,i=e.length,j=g,k=h,l=Array(i),m=Array(i),n=numeric.add,o=numeric.mul,p=numeric.div,q=numeric.sub;for(a=i-1;-1!==a;--a)b=d[a+1]-d[a],c=q(f[a+1],e[a]),l[a]=p(n(o(c,6),o(g[a],-4*b),o(h[a+1],-2*b)),b*b),m[a+1]=p(n(o(c,-6),o(g[a],2*b),o(h[a+1],4*b)),b*b);return new numeric.Spline(d,j,k,l,m)},numeric.Spline.prototype.roots=function(){function a(a){return a*a}var b=[],c=this.x,d=this.yl,e=this.yr,f=this.kl,g=this.kr;"number"==typeof d[0]&&(d=[d],e=[e],f=[f],g=[g]);var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=d.length,F=c.length-1,b=Array(E),G=Math.sqrt;for(h=0;h!==E;++h){for(k=d[h],l=e[h],m=f[h],n=g[h],o=[],i=0;i!==F;i++){for(i>0&&l[i]*k[i]<0&&o.push(c[i]),w=c[i+1]-c[i],c[i],r=k[i],s=l[i+1],p=m[i]/w,q=n[i+1]/w,v=a(p-q+3*(r-s))+12*q*r,t=q+3*r+2*p-3*s,u=3*(q+p+2*(r-s)),v<=0?(y=t/u,x=y>c[i]&&y<c[i+1]?[c[i],y,c[i+1]]:[c[i],c[i+1]]):(y=(t-G(v))/u,z=(t+G(v))/u,x=[c[i]],y>c[i]&&y<c[i+1]&&x.push(y),z>c[i]&&z<c[i+1]&&x.push(z),x.push(c[i+1])),B=x[0],y=this._at(B,i),j=0;j<x.length-1;j++)if(C=x[j+1],z=this._at(C,i),0!==y)if(0===z||y*z>0)B=C,y=z;else{for(var H=0;;){if((D=(y*C-z*B)/(y-z))<=B||D>=C)break;if((A=this._at(D,i))*z>0)C=D,z=A,-1===H&&(y*=.5),H=-1;else{if(!(A*y>0))break;B=D,y=A,1===H&&(z*=.5),H=1}}o.push(D),B=x[j+1],y=this._at(B,i)}else o.push(B),B=C,y=z;0===z&&o.push(C)}b[h]=o}return"number"==typeof this.yl[0]?b[0]:b},numeric.spline=function(a,b,c,d){var e,f=a.length,g=[],h=[],i=[],j=numeric.sub,k=numeric.mul,l=numeric.add;for(e=f-2;e>=0;e--)h[e]=a[e+1]-a[e],i[e]=j(b[e+1],b[e]);"string"!=typeof c&&"string"!=typeof d||(c=d="periodic");var m=[[],[],[]];switch(void 0===c?"undefined":_typeof(c)){case"undefined":g[0]=k(3/(h[0]*h[0]),i[0]),m[0].push(0,0),m[1].push(0,1),m[2].push(2/h[0],1/h[0]);break;case"string":g[0]=l(k(3/(h[f-2]*h[f-2]),i[f-2]),k(3/(h[0]*h[0]),i[0])),m[0].push(0,0,0),m[1].push(f-2,0,1),m[2].push(1/h[f-2],2/h[f-2]+2/h[0],1/h[0]);break;default:g[0]=c,m[0].push(0),m[1].push(0),m[2].push(1)}for(e=1;e<f-1;e++)g[e]=l(k(3/(h[e-1]*h[e-1]),i[e-1]),k(3/(h[e]*h[e]),i[e])),m[0].push(e,e,e),m[1].push(e-1,e,e+1),m[2].push(1/h[e-1],2/h[e-1]+2/h[e],1/h[e]);switch(void 0===d?"undefined":_typeof(d)){case"undefined":g[f-1]=k(3/(h[f-2]*h[f-2]),i[f-2]),m[0].push(f-1,f-1),m[1].push(f-2,f-1),m[2].push(1/h[f-2],2/h[f-2]);break;case"string":m[1][m[1].length-1]=0;break;default:g[f-1]=d,m[0].push(f-1),m[1].push(f-1),m[2].push(1)}g="number"!=typeof g[0]?numeric.transpose(g):[g];var n=Array(g.length);if("string"==typeof c)for(e=n.length-1;-1!==e;--e)n[e]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(m)),g[e]),n[e][f-1]=n[e][0];else for(e=n.length-1;-1!==e;--e)n[e]=numeric.cLUsolve(numeric.cLU(m),g[e]);return n="number"==typeof b[0]?n[0]:numeric.transpose(n),new numeric.Spline(a,b,b,n,n)},numeric.fftpow2=function a(b,c){var d=b.length;if(1!==d){var e,f,g=Math.cos,h=Math.sin,i=Array(d/2),j=Array(d/2),k=Array(d/2),l=Array(d/2);for(f=d/2,e=d-1;-1!==e;--e)--f,k[f]=b[e],l[f]=c[e],--e,i[f]=b[e],j[f]=c[e];a(i,j),a(k,l),f=d/2;var m,n,o,p=-6.283185307179586/d;for(e=d-1;-1!==e;--e)--f,-1===f&&(f=d/2-1),m=p*e,n=g(m),o=h(m),b[e]=i[f]+n*k[f]-o*l[f],c[e]=j[f]+n*l[f]+o*k[f]}},numeric._ifftpow2=function a(b,c){var d=b.length;if(1!==d){var e,f,g=Math.cos,h=Math.sin,i=Array(d/2),j=Array(d/2),k=Array(d/2),l=Array(d/2);for(f=d/2,e=d-1;-1!==e;--e)--f,k[f]=b[e],l[f]=c[e],--e,i[f]=b[e],j[f]=c[e];a(i,j),a(k,l),f=d/2;var m,n,o,p=6.283185307179586/d;for(e=d-1;-1!==e;--e)--f,-1===f&&(f=d/2-1),m=p*e,n=g(m),o=h(m),b[e]=i[f]+n*k[f]-o*l[f],c[e]=j[f]+n*l[f]+o*k[f]}},numeric.ifftpow2=function(a,b){numeric._ifftpow2(a,b),numeric.diveq(a,a.length),numeric.diveq(b,b.length)},numeric.convpow2=function(a,b,c,d){numeric.fftpow2(a,b),numeric.fftpow2(c,d);var e,f,g,h,i,j=a.length;for(e=j-1;-1!==e;--e)f=a[e],h=b[e],g=c[e],i=d[e],a[e]=f*g-h*i,b[e]=f*i+h*g;numeric.ifftpow2(a,b)},numeric.T.prototype.fft=function(){var a,b,c=this.x,d=this.y,e=c.length,f=Math.log,g=f(2),h=Math.ceil(f(2*e-1)/g),i=Math.pow(2,h),j=numeric.rep([i],0),k=numeric.rep([i],0),l=Math.cos,m=Math.sin,n=-3.141592653589793/e,o=numeric.rep([i],0),p=numeric.rep([i],0);Math.floor(e/2);for(a=0;a<e;a++)o[a]=c[a];if(void 0!==d)for(a=0;a<e;a++)p[a]=d[a];for(j[0]=1,a=1;a<=i/2;a++)b=n*a*a,j[a]=l(b),k[a]=m(b),j[i-a]=l(b),k[i-a]=m(b);var q=new numeric.T(o,p),r=new numeric.T(j,k);return q=q.mul(r),numeric.convpow2(q.x,q.y,numeric.clone(r.x),numeric.neg(r.y)),q=q.mul(r),q.x.length=e,q.y.length=e,q},numeric.T.prototype.ifft=function(){var a,b,c=this.x,d=this.y,e=c.length,f=Math.log,g=f(2),h=Math.ceil(f(2*e-1)/g),i=Math.pow(2,h),j=numeric.rep([i],0),k=numeric.rep([i],0),l=Math.cos,m=Math.sin,n=3.141592653589793/e,o=numeric.rep([i],0),p=numeric.rep([i],0);Math.floor(e/2);for(a=0;a<e;a++)o[a]=c[a];if(void 0!==d)for(a=0;a<e;a++)p[a]=d[a];for(j[0]=1,a=1;a<=i/2;a++)b=n*a*a,j[a]=l(b),k[a]=m(b),j[i-a]=l(b),k[i-a]=m(b);var q=new numeric.T(o,p),r=new numeric.T(j,k);return q=q.mul(r),numeric.convpow2(q.x,q.y,numeric.clone(r.x),numeric.neg(r.y)),q=q.mul(r),q.x.length=e,q.y.length=e,q.div(e)},numeric.gradient=function(a,b){var c=b.length,d=a(b);if(isNaN(d))throw new Error("gradient: f(x) is a NaN!");var e,f,g,h,i,j,k,l,m,n=Math.max,o=numeric.clone(b),p=Array(c),n=(numeric.div,numeric.sub,Math.max),q=.001,r=Math.abs,s=Math.min,t=0;for(e=0;e<c;e++)for(var u=n(1e-6*d,1e-8);;){if(++t>20)throw new Error("Numerical gradient fails");if(o[e]=b[e]+u,f=a(o),o[e]=b[e]-u,g=a(o),o[e]=b[e],isNaN(f)||isNaN(g))u/=16;else{if(p[e]=(f-g)/(2*u),h=b[e]-u,i=b[e],j=b[e]+u,k=(f-d)/u,l=(d-g)/u,m=n(r(p[e]),r(d),r(f),r(g),r(h),r(i),r(j),1e-8),!(s(n(r(k-p[e]),r(l-p[e]),r(k-l))/m,u/m)>q))break;u/=16}}return p},numeric.uncmin=function(a,b,c,d,e,f,g){var h=numeric.gradient;void 0===g&&(g={}),void 0===c&&(c=1e-8),void 0===d&&(d=function(b){return h(a,b)}),void 0===e&&(e=1e3),b=numeric.clone(b);var i,j,k=b.length,l=a(b);if(isNaN(l))throw new Error("uncmin: f(x0) is a NaN!");var m=Math.max,n=numeric.norm2;c=m(c,numeric.epsilon);var o,p,q,r,s,t,u,v,w,x,y=g.Hinv||numeric.identity(k),z=numeric.dot,A=(numeric.inv,numeric.sub),B=numeric.add,C=numeric.tensor,D=numeric.div,E=numeric.mul,F=numeric.all,G=numeric.isFinite,H=numeric.neg,I=0,J="";for(p=d(b);I<e;){if("function"==typeof f&&f(I,b,l,p,y)){J="Callback returned true";break}if(!F(G(p))){J="Gradient has Infinity or NaN";break}if(o=H(z(y,p)),!F(G(o))){J="Search direction has Infinity or NaN";break}if((x=n(o))<c){J="Newton step smaller than tol";break}for(w=1,j=z(p,o),s=b;I<e&&!(w*x<c)&&(r=E(o,w),s=B(b,r),(i=a(s))-l>=.1*w*j||isNaN(i));)w*=.5,++I;if(w*x<c){J="Line search step size smaller than tol";break}if(I===e){J="maxit reached during line search";break}q=d(s),t=A(q,p),v=z(t,r),u=z(y,t),y=A(B(y,E((v+z(t,u))/(v*v),C(r,r))),D(B(C(u,r),C(r,u)),v)),b=s,l=i,p=q,++I}return{solution:b,f:l,gradient:p,invHessian:y,iterations:I,message:J}},numeric.Dopri=function(a,b,c,d,e,f,g){this.x=a,this.y=b,this.f=c,this.ymid=d,this.iterations=e,this.events=g,this.message=f},numeric.Dopri.prototype._at=function(a,b){function c(a){return a*a}var d,e,f,g,h,i,a,j,k,l,m,n=this,o=n.x,p=n.y,q=n.f,r=n.ymid,s=(o.length,Math.floor,.5),t=numeric.add,u=numeric.mul,v=numeric.sub;return d=o[b],e=o[b+1],g=p[b],h=p[b+1],j=e-d,f=d+s*j,i=r[b],k=v(q[b],u(g,1/(d-f)+2/(d-e))),l=v(q[b+1],u(h,1/(e-f)+2/(e-d))),m=[c(a-e)*(a-f)/c(d-e)/(d-f),c(a-d)*c(a-e)/c(d-f)/c(e-f),c(a-d)*(a-f)/c(e-d)/(e-f),(a-d)*c(a-e)*(a-f)/c(d-e)/(d-f),(a-e)*c(a-d)*(a-f)/c(d-e)/(e-f)],t(t(t(t(u(g,m[0]),u(i,m[1])),u(h,m[2])),u(k,m[3])),u(l,m[4]))},numeric.Dopri.prototype.at=function(a){var b,c,d,e=Math.floor;if("number"!=typeof a){var f=a.length,g=Array(f);for(b=f-1;-1!==b;--b)g[b]=this.at(a[b]);return g}var h=this.x;for(b=0,c=h.length-1;c-b>1;)d=e(.5*(b+c)),h[d]<=a?b=d:c=d;return this._at(a,b)},numeric.dopri=function(a,b,c,d,e,f,g){void 0===e&&(e=1e-6),void 0===f&&(f=1e3);var h,i,j,k,l,m,n,o,p,q,r,s,t,u=[a],v=[c],w=[d(a,c)],x=[],y=.2,z=[.075,.225],A=[44/45,-56/15,32/9],B=[19372/6561,-25360/2187,64448/6561,-212/729],C=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],D=[35/384,0,500/1113,125/192,-2187/6784,11/84],E=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],F=[.2,.3,.8,8/9,1,1],G=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],H=0,I=(b-a)/10,J=0,K=numeric.add,L=numeric.mul,M=(Math.max,Math.min),N=Math.abs,O=numeric.norminf,P=Math.pow,Q=numeric.any,R=numeric.lt,S=numeric.and,T=(numeric.sub,new numeric.Dopri(u,v,w,x,-1,""));for("function"==typeof g&&(r=g(a,c));a<b&&J<f;)if(++J,a+I>b&&(I=b-a),h=d(a+F[0]*I,K(c,L(y*I,w[H]))),i=d(a+F[1]*I,K(K(c,L(z[0]*I,w[H])),L(z[1]*I,h))),j=d(a+F[2]*I,K(K(K(c,L(A[0]*I,w[H])),L(A[1]*I,h)),L(A[2]*I,i))),k=d(a+F[3]*I,K(K(K(K(c,L(B[0]*I,w[H])),L(B[1]*I,h)),L(B[2]*I,i)),L(B[3]*I,j))),l=d(a+F[4]*I,K(K(K(K(K(c,L(C[0]*I,w[H])),L(C[1]*I,h)),L(C[2]*I,i)),L(C[3]*I,j)),L(C[4]*I,k))),p=K(K(K(K(K(c,L(w[H],I*D[0])),L(i,I*D[2])),L(j,I*D[3])),L(k,I*D[4])),L(l,I*D[5])),m=d(a+I,p),n=K(K(K(K(K(L(w[H],I*G[0]),L(i,I*G[2])),L(j,I*G[3])),L(k,I*G[4])),L(l,I*G[5])),L(m,I*G[6])),(q="number"==typeof n?N(n):O(n))>e){if(I=.2*I*P(e/q,.25),a+I===a){T.msg="Step size became too small";break}}else{if(x[H]=K(K(K(K(K(K(c,L(w[H],I*E[0])),L(i,I*E[2])),L(j,I*E[3])),L(k,I*E[4])),L(l,I*E[5])),L(m,I*E[6])),++H,u[H]=a+I,v[H]=p,w[H]=m,"function"==typeof g){var U,V,W=a,X=a+.5*I;if(s=g(X,x[H-1]),t=S(R(r,0),R(0,s)),Q(t)||(W=X,X=a+I,r=s,s=g(X,p),t=S(R(r,0),R(0,s))),Q(t)){for(var Y,Z,$=0,_=1,aa=1;;){if("number"==typeof r)V=(aa*s*W-_*r*X)/(aa*s-_*r);else for(V=X,o=r.length-1;-1!==o;--o)r[o]<0&&s[o]>0&&(V=M(V,(aa*s[o]*W-_*r[o]*X)/(aa*s[o]-_*r[o])));if(V<=W||V>=X)break;U=T._at(V,H-1),Z=g(V,U),Y=S(R(r,0),R(0,Z)),Q(Y)?(X=V,s=Z,t=Y,aa=1,-1===$?_*=.5:_=1,$=-1):(W=V,r=Z,_=1,1===$?aa*=.5:aa=1,$=1)}return p=T._at(.5*(a+V),H-1),T.f[H]=d(V,U),T.x[H]=V,T.y[H]=U,T.ymid[H-1]=p,T.events=t,T.iterations=J,T}}a+=I,c=p,r=s,I=M(.8*I*P(e/q,.25),4*I)}return T.iterations=J,T},numeric.LU=function(a,b){b=b||!1;var c,d,e,f,g,h,i,j,k,l=Math.abs,m=a.length,n=m-1,o=new Array(m);for(b||(a=numeric.clone(a)),e=0;e<m;++e){for(i=e,h=a[e],k=l(h[e]),d=e+1;d<m;++d)f=l(a[d][e]),k<f&&(k=f,i=d);for(o[e]=i,i!=e&&(a[e]=a[i],a[i]=h,h=a[e]),g=h[e],c=e+1;c<m;++c)a[c][e]/=g;for(c=e+1;c<m;++c){for(j=a[c],d=e+1;d<n;++d)j[d]-=j[e]*h[d],++d,j[d]-=j[e]*h[d];d===n&&(j[d]-=j[e]*h[d])}}return{LU:a,P:o}},numeric.LUsolve=function(a,b){var c,d,e,f,g,h=a.LU,i=h.length,j=numeric.clone(b),k=a.P;for(c=i-1;-1!==c;--c)j[c]=b[c];for(c=0;c<i;++c)for(e=k[c],k[c]!==c&&(g=j[c],j[c]=j[e],j[e]=g),f=h[c],d=0;d<c;++d)j[c]-=j[d]*f[d];for(c=i-1;c>=0;--c){for(f=h[c],d=c+1;d<i;++d)j[c]-=j[d]*f[d];j[c]/=f[c]}return j},numeric.solve=function(a,b,c){return numeric.LUsolve(numeric.LU(a,c),b)},numeric.echelonize=function(a){var b,c,d,e,f,g,h,i,j=numeric.dim(a),k=j[0],l=j[1],m=numeric.identity(k),n=Array(k),o=Math.abs,p=numeric.diveq;for(a=numeric.clone(a),b=0;b<k;++b){for(d=0,f=a[b],g=m[b],c=1;c<l;++c)o(f[d])<o(f[c])&&(d=c);for(n[b]=d,p(g,f[d]),p(f,f[d]),c=0;c<k;++c)if(c!==b){for(h=a[c],i=h[d],e=l-1;-1!==e;--e)h[e]-=f[e]*i;for(h=m[c],e=k-1;-1!==e;--e)h[e]-=g[e]*i}}return{I:m,A:a,P:n}},numeric.__solveLP=function(a,b,c,d,e,f,g){var h,i,j,k,l=numeric.sum,m=(numeric.log,numeric.mul),n=numeric.sub,o=numeric.dot,p=numeric.div,q=numeric.add,r=a.length,s=c.length,t=!1,u=0,v=1,w=(numeric.transpose(b),numeric.svd,numeric.transpose),x=(numeric.leq,Math.sqrt),y=Math.abs,z=(numeric.muleq,numeric.norminf,numeric.any,Math.min),A=numeric.all,B=numeric.gt,C=Array(r),D=Array(s),E=(numeric.rep([s],1),numeric.solve),F=n(c,o(b,f)),G=o(a,a);for(j=u;j<e;++j){var H,I;for(H=s-1;-1!==H;--H)D[H]=p(b[H],F[H]);var J=w(D);for(H=r-1;-1!==H;--H)C[H]=l(J[H]);v=.25*y(G/o(a,C));var K=100*x(G/o(C,C));for((!isFinite(v)||v>K)&&(v=K),k=q(a,m(v,C)),i=o(J,D),H=r-1;-1!==H;--H)i[H][H]+=1;I=E(i,p(k,v),!0);var L=p(F,o(b,I)),M=1;for(H=s-1;-1!==H;--H)L[H]<0&&(M=z(M,-.999*L[H]));if(h=n(f,m(I,M)),F=n(c,o(b,h)),!A(B(F,0)))return{solution:f,message:"",iterations:j};if(f=h,v<d)return{solution:h,message:"",iterations:j};if(g){var N=o(a,k),O=o(b,k);for(t=!0,H=s-1;-1!==H;--H)if(N*O[H]<0){t=!1;break}}else t=!(f[r-1]>=0);if(t)return{solution:h,message:"Unbounded",iterations:j}}return{solution:f,message:"maximum iteration count exceeded",iterations:j}},numeric._solveLP=function(a,b,c,d,e){var f,g=a.length,h=c.length,i=(numeric.sum,numeric.log,numeric.mul,numeric.sub),j=numeric.dot,k=(numeric.div,numeric.add,numeric.rep([g],0).concat([1])),l=numeric.rep([h,1],-1),m=numeric.blockMatrix([[b,l]]),n=c,f=numeric.rep([g],0).concat(Math.max(0,numeric.sup(numeric.neg(c)))+1),o=numeric.__solveLP(k,m,n,d,e,f,!1),p=numeric.clone(o.solution);if(p.length=g,numeric.inf(i(c,j(b,p)))<0)return{solution:NaN,message:"Infeasible",iterations:o.iterations};var q=numeric.__solveLP(a,b,c,d,e-o.iterations,p,!0);return q.iterations+=o.iterations,q},numeric.solveLP=function(a,b,c,d,e,f,g){if(void 0===g&&(g=1e3),void 0===f&&(f=numeric.epsilon),void 0===d)return numeric._solveLP(a,b,c,f,g);var h,i=d.length,j=d[0].length,k=b.length,l=numeric.echelonize(d),m=numeric.rep([j],0),n=l.P,o=[];for(h=n.length-1;-1!==h;--h)m[n[h]]=1;for(h=j-1;-1!==h;--h)0===m[h]&&o.push(h);var p=numeric.getRange,q=numeric.linspace(0,i-1),r=numeric.linspace(0,k-1),s=p(d,q,o),t=p(b,r,n),u=p(b,r,o),v=numeric.dot,w=numeric.sub,x=v(t,l.I),y=w(u,v(x,s)),z=w(c,v(x,e)),A=Array(n.length),B=Array(o.length);for(h=n.length-1;-1!==h;--h)A[h]=a[n[h]];for(h=o.length-1;-1!==h;--h)B[h]=a[o[h]];var C=w(B,v(A,v(l.I,s))),D=numeric._solveLP(C,y,z,f,g),E=D.solution;if(E!==E)return D;var F=v(l.I,w(e,v(s,E))),G=Array(a.length);for(h=n.length-1;-1!==h;--h)G[n[h]]=F[h];for(h=o.length-1;-1!==h;--h)G[o[h]]=E[h];return{solution:G,message:D.message,iterations:D.iterations}},numeric.MPStoLP=function(a){function b(b){throw new Error("MPStoLP: "+b+"\nLine "+c+": "+a[c]+"\nCurrent state: "+h[g]+"\n")}a instanceof String&&a.split("\n");var c,d,e,f,g=0,h=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],i=a.length,j=0,k={},l=[],m=0,n={},o=0,p=[],q=[],r=[];for(c=0;c<i;++c){e=a[c];var s=e.match(/\S*/g),t=[];for(d=0;d<s.length;++d)""!==s[d]&&t.push(s[d]);if(0!==t.length){for(d=0;d<h.length&&e.substr(0,h[d].length)!==h[d];++d);if(d<h.length){if(g=d,1===d&&(f=t[1]),6===d)return{name:f,c:p,A:numeric.transpose(q),b:r,rows:k,vars:n}}else switch(g){case 0:case 1:b("Unexpected line");case 2:switch(t[0]){case"N":0===j?j=t[1]:b("Two or more N rows");break;case"L":k[t[1]]=m,l[m]=1,r[m]=0,++m;break;case"G":k[t[1]]=m,l[m]=-1,r[m]=0,++m;break;case"E":k[t[1]]=m,l[m]=0,r[m]=0,++m;break;default:b("Parse error "+numeric.prettyPrint(t))}break;case 3:n.hasOwnProperty(t[0])||(n[t[0]]=o,p[o]=0,q[o]=numeric.rep([m],0),++o);var u=n[t[0]];for(d=1;d<t.length;d+=2)if(t[d]!==j){var v=k[t[d]];q[u][v]=(l[v]<0?-1:1)*parseFloat(t[d+1])}else p[u]=parseFloat(t[d+1]);break;case 4:for(d=1;d<t.length;d+=2)r[k[t[d]]]=(l[k[t[d]]]<0?-1:1)*parseFloat(t[d+1]);break;case 5:break;case 6:b("Internal error")}}}b("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(a,b,c,d,e,f,g){function h(a){var b,d,e=this,f=a.length,g=0,h=e.i=e.j=e.m=0;for(e.S=[],e.c=[],f||(a=[f++]);g<c;)e.S[g]=g++;for(g=0;g<c;g++)b=e.S[g],h=k(h+b+a[g%f]),d=e.S[h],e.S[g]=d,e.S[h]=b;e.g=function(a){var b=e.S,d=k(e.i+1),f=b[d],g=k(e.j+f),h=b[g];b[d]=h,b[g]=f;for(var i=b[k(f+h)];--a;)d=k(d+1),f=b[d],g=k(g+f),h=b[g],b[d]=h,b[g]=f,i=i*c+b[k(f+h)];return e.i=d,e.j=g,i},e.g(c)}function i(a,b,c,d,e){if(c=[],e=void 0===a?"undefined":_typeof(a),b&&"object"==e)for(d in a)if(d.indexOf("S")<5)try{c.push(i(a[d],b-1))}catch(a){}return c.length?c:a+("string"!=e?"\0":"")}function j(a,b,c,d){for(a+="",c=0,d=0;d<a.length;d++)b[k(d)]=k((c^=19*b[k(d)])+a.charCodeAt(d));a="";for(d in b)a+=String.fromCharCode(b[d]);return a}function k(a){return a&c-1}b.seedrandom=function(k,l){var m,n=[];return k=j(i(l?[k,a]:arguments.length?k:[(new Date).getTime(),a,window],3),n),m=new h(n),j(m.S,a),b.random=function(){for(var a=m.g(d),b=g,h=0;a<e;)a=(a+h)*c,b*=c,h=m.g(1);for(;a>=f;)a/=2,b/=2,h>>>=1;return(a+h)/b},k},g=b.pow(c,d),e=b.pow(2,e),f=2*e,j(b.random(),a)}([],numeric.seedrandom,256,6,52),function(a){function b(a){if("object"!==(void 0===a?"undefined":_typeof(a)))return a;var c,d=[],e=a.length;for(c=0;c<e;c++)d[c+1]=b(a[c]);return d}function c(a){if("object"!==(void 0===a?"undefined":_typeof(a)))return a;var b,d=[],e=a.length;for(b=1;b<e;b++)d[b-1]=c(a[b]);return d}function d(a,b,c){var d,e,f,g,h;for(f=1;f<=c;f+=1){for(a[f][f]=1/a[f][f],h=-a[f][f],d=1;d<f;d+=1)a[d][f]=h*a[d][f];if(g=f+1,c<g)break;for(e=g;e<=c;e+=1)for(h=a[f][e],a[f][e]=0,d=1;d<=f;d+=1)a[d][e]=a[d][e]+h*a[d][f]}}function e(a,b,c,d){var e,f,g,h;for(f=1;f<=c;f+=1){for(h=0,e=1;e<f;e+=1)h+=a[e][f]*d[e];d[f]=(d[f]-h)/a[f][f]}for(g=1;g<=c;g+=1)for(f=c+1-g,d[f]=d[f]/a[f][f],h=-d[f],e=1;e<f;e+=1)d[e]=d[e]+h*a[e][f]}function f(a,b,c,d){var e,f,g,h,i,j;for(f=1;f<=c;f+=1){if(d[1]=f,j=0,(g=f-1)<1){if((j=a[f][f]-j)<=0)break;a[f][f]=Math.sqrt(j)}else{for(h=1;h<=g;h+=1){for(i=a[h][f],e=1;e<h;e+=1)i-=a[e][f]*a[e][h];i/=a[h][h],a[h][f]=i,j+=i*i}if((j=a[f][f]-j)<=0)break;a[f][f]=Math.sqrt(j)}d[1]=0}}function g(a,b,c,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(){for(q[1]=q[1]+1,A=H,y=1;y<=m;y+=1){for(A+=1,N=-k[y],z=1;z<=g;z+=1)N+=j[z][y]*h[z];if(Math.abs(N)<V&&(N=0),y>n)r[A]=N;else if(r[A]=-Math.abs(N),N>0){for(z=1;z<=g;z+=1)j[z][y]=-j[z][y];k[y]=-k[y]}}for(y=1;y<=p;y+=1)r[H+o[y]]=0;for(J=0,M=0,y=1;y<=m;y+=1)r[H+y]<M*r[L+y]&&(J=y,M=r[H+y]/r[L+y]);return 0===J?999:0}function u(){for(y=1;y<=g;y+=1){for(N=0,z=1;z<=g;z+=1)N+=a[z][y]*j[z][J];r[y]=N}for(B=E,y=1;y<=g;y+=1)r[B+y]=0;for(z=p+1;z<=g;z+=1)for(y=1;y<=g;y+=1)r[B+y]=r[B+y]+a[y][z]*r[z];for(T=!0,y=p;y>=1;y-=1){for(N=r[y],A=G+y*(y+3)/2,B=A-y,z=y+1;z<=p;z+=1)N-=r[A]*r[F+z],A+=z;if(N/=r[B],r[F+y]=N,o[y]<n)break;if(N<0)break;T=!1,D=y}if(!T)for(O=r[I+D]/r[F+D],y=1;y<=p&&!(o[y]<n)&&!(r[F+y]<0);y+=1)(M=r[I+y]/r[F+y])<O&&(O=M,D=y);for(N=0,y=E+1;y<=E+g;y+=1)N+=r[y]*r[y];if(Math.abs(N)<=V){if(T)return s[1]=1,999;for(y=1;y<=p;y+=1)r[I+y]=r[I+y]-O*r[F+y];return r[I+p+1]=r[I+p+1]+O,700}for(N=0,y=1;y<=g;y+=1)N+=r[E+y]*j[y][J];for(P=-r[H+J]/N,U=!0,T||O<P&&(P=O,U=!1),y=1;y<=g;y+=1)h[y]=h[y]+P*r[E+y],Math.abs(h[y])<V&&(h[y]=0);for(i[1]=i[1]+P*N*(P/2+r[I+p+1]),y=1;y<=p;y+=1)r[I+y]=r[I+y]-P*r[F+y];if(r[I+p+1]=r[I+p+1]+P,!U){for(N=-k[J],z=1;z<=g;z+=1)N+=h[z]*j[z][J];if(J>n)r[H+J]=N;else if(r[H+J]=-Math.abs(N),N>0){for(z=1;z<=g;z+=1)j[z][J]=-j[z][J];k[J]=-k[J]}return 700}for(p+=1,o[p]=J,A=G+(p-1)*p/2+1,y=1;y<=p-1;y+=1)r[A]=r[y],A+=1;if(p===g)r[A]=r[g];else{for(y=g;y>=p+1&&0!==r[y]&&(Q=Math.max(Math.abs(r[y-1]),Math.abs(r[y])),R=Math.min(Math.abs(r[y-1]),Math.abs(r[y])),M=r[y-1]>=0?Math.abs(Q*Math.sqrt(1+R*R/(Q*Q))):-Math.abs(Q*Math.sqrt(1+R*R/(Q*Q))),Q=r[y-1]/M,R=r[y]/M,1!==Q);y-=1)if(0===Q)for(r[y-1]=R*M,z=1;z<=g;z+=1)M=a[z][y-1],a[z][y-1]=a[z][y],a[z][y]=M;else for(r[y-1]=M,S=R/(1+Q),z=1;z<=g;z+=1)M=Q*a[z][y-1]+R*a[z][y],a[z][y]=S*(a[z][y-1]+M)-a[z][y],a[z][y-1]=M;r[A]=r[p]}return 0}function v(){if(A=G+D*(D+1)/2+1,B=A+D,0===r[B])return 798;if(Q=Math.max(Math.abs(r[B-1]),Math.abs(r[B])),R=Math.min(Math.abs(r[B-1]),Math.abs(r[B])),M=r[B-1]>=0?Math.abs(Q*Math.sqrt(1+R*R/(Q*Q))):-Math.abs(Q*Math.sqrt(1+R*R/(Q*Q))),Q=r[B-1]/M,R=r[B]/M,1===Q)return 798;if(0===Q){for(y=D+1;y<=p;y+=1)M=r[B-1],r[B-1]=r[B],r[B]=M,B+=y;for(y=1;y<=g;y+=1)M=a[y][D],a[y][D]=a[y][D+1],a[y][D+1]=M}else{for(S=R/(1+Q),y=D+1;y<=p;y+=1)M=Q*r[B-1]+R*r[B],r[B]=S*(r[B-1]+M)-r[B],r[B-1]=M,B+=y;for(y=1;y<=g;y+=1)M=Q*a[y][D]+R*a[y][D+1],a[y][D+1]=S*(a[y][D]+M)-a[y][D+1],a[y][D]=M}return 0}function w(){for(B=A-D,y=1;y<=D;y+=1)r[B]=r[A],A+=1,B+=1;return r[I+D]=r[I+D+1],o[D]=o[D+1],D+=1,D<p?797:0}function x(){return r[I+p]=r[I+p+1],r[I+p+1]=0,o[p]=0,p-=1,q[2]=q[2]+1,0}var y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y;K=Math.min(g,m),A=2*g+K*(K+5)/2+2*m+1,V=1e-60;do{V+=V,W=1+.1*V,X=1+.2*V}while(W<=1||X<=1);for(y=1;y<=g;y+=1)r[y]=b[y];for(y=g+1;y<=A;y+=1)r[y]=0;for(y=1;y<=m;y+=1)o[y]=0;if(C=[],0===s[1]){if(f(a,c,g,C),0!==C[1])return void(s[1]=2);e(a,c,g,b),d(a,c,g)}else{for(z=1;z<=g;z+=1)for(h[z]=0,y=1;y<=z;y+=1)h[z]=h[z]+a[y][z]*b[y];for(z=1;z<=g;z+=1)for(b[z]=0,y=z;y<=g;y+=1)b[z]=b[z]+a[z][y]*h[y]}for(i[1]=0,z=1;z<=g;z+=1)for(h[z]=b[z],i[1]=i[1]+r[z]*h[z],r[z]=0,y=z+1;y<=g;y+=1)a[y][z]=0;for(i[1]=-i[1]/2,s[1]=0,E=g,F=E+g,I=F+K,G=I+K+1,H=G+K*(K+1)/2,L=H+m,y=1;y<=m;y+=1){for(N=0,z=1;z<=g;z+=1)N+=j[z][y]*j[z][y];r[L+y]=Math.sqrt(N)}for(p=0,q[1]=0,q[2]=0,Y=0;;){if(999===(Y=t()))return;for(;;){if(0===(Y=u()))break;if(999===Y)return;if(700===Y)if(D===p)x();else{for(;;)if(v(),797!==(Y=w()))break;x()}}}}function h(a,d,e,f,h,i){a=b(a),d=b(d),e=b(e);var j,k,l,m,n,o,p=[],q=[],r=[],s=[],t=[];if(h=h||0,i=i?b(i):[void 0,0],f=f?b(f):[],k=a.length-1,l=e[1].length-1,!f)for(j=1;j<=l;j+=1)f[j]=0;for(j=1;j<=l;j+=1)q[j]=0;for(m=0,n=Math.min(k,l),j=1;j<=k;j+=1)r[j]=0;for(p[1]=0,j=1;j<=2*k+n*(n+5)/2+2*l+1;j+=1)s[j]=0;for(j=1;j<=2;j+=1)t[j]=0;return g(a,d,k,k,r,p,e,f,k,l,h,q,m,t,s,i),o="",1===i[1]&&(o="constraints are inconsistent, no solution!"),2===i[1]&&(o="matrix D in quadratic function is not positive definite!"),{solution:c(r),value:c(p),unconstrained_solution:c(d),iterations:c(t),iact:c(q),message:o}}a.solveQP=h}(numeric),numeric.svd=function(a){function b(a,b){return a=Math.abs(a),b=Math.abs(b),a>b?a*Math.sqrt(1+b*b/a/a):0==b?a:b*Math.sqrt(1+a*a/b/b)}var c,d=numeric.epsilon,e=1e-64/d,f=50,g=0,h=0,i=0,j=0,k=0,l=numeric.clone(a),m=l.length,n=l[0].length;if(m<n)throw"Need more rows than columns";var o=new Array(n),p=new Array(n);for(h=0;h<n;h++)o[h]=p[h]=0;var q=numeric.rep([n,n],0),r=0,s=0,t=0,u=0,v=0,w=0,x=0;for(h=0;h<n;h++){for(o[h]=s,x=0,k=h+1,i=h;i<m;i++)x+=l[i][h]*l[i][h];if(x<=e)s=0;else for(r=l[h][h],s=Math.sqrt(x),r>=0&&(s=-s),t=r*s-x,l[h][h]=r-s,i=k;i<n;i++){for(x=0,j=h;j<m;j++)x+=l[j][h]*l[j][i];for(r=x/t,j=h;j<m;j++)l[j][i]+=r*l[j][h]}for(p[h]=s,x=0,i=k;i<n;i++)x+=l[h][i]*l[h][i];if(x<=e)s=0;else{for(r=l[h][h+1],s=Math.sqrt(x),r>=0&&(s=-s),t=r*s-x,l[h][h+1]=r-s,i=k;i<n;i++)o[i]=l[h][i]/t;for(i=k;i<m;i++){for(x=0,j=k;j<n;j++)x+=l[i][j]*l[h][j];for(j=k;j<n;j++)l[i][j]+=x*o[j]}}v=Math.abs(p[h])+Math.abs(o[h]),v>u&&(u=v)}for(h=n-1;-1!=h;h+=-1){if(0!=s){for(t=s*l[h][h+1],i=k;i<n;i++)q[i][h]=l[h][i]/t;for(i=k;i<n;i++){for(x=0,j=k;j<n;j++)x+=l[h][j]*q[j][i];for(j=k;j<n;j++)q[j][i]+=x*q[j][h]}}for(i=k;i<n;i++)q[h][i]=0,q[i][h]=0;q[h][h]=1,s=o[h],k=h}for(h=n-1;-1!=h;h+=-1){for(k=h+1,s=p[h],i=k;i<n;i++)l[h][i]=0;if(0!=s){for(t=l[h][h]*s,i=k;i<n;i++){for(x=0,j=k;j<m;j++)x+=l[j][h]*l[j][i];for(r=x/t,j=h;j<m;j++)l[j][i]+=r*l[j][h]}for(i=h;i<m;i++)l[i][h]=l[i][h]/s}else for(i=h;i<m;i++)l[i][h]=0;l[h][h]+=1}for(d*=u,j=n-1;-1!=j;j+=-1)for(var y=0;y<f;y++){var z=!1;for(k=j;-1!=k;k+=-1){if(Math.abs(o[k])<=d){z=!0;break}if(Math.abs(p[k-1])<=d)break}if(!z){g=0,x=1;var A=k-1;for(h=k;h<j+1&&(r=x*o[h],o[h]=g*o[h],!(Math.abs(r)<=d));h++)for(s=p[h],t=b(r,s),p[h]=t,g=s/t,x=-r/t,i=0;i<m;i++)v=l[i][A],w=l[i][h],l[i][A]=v*g+w*x,l[i][h]=-v*x+w*g}if(w=p[j],k==j){if(w<0)for(p[j]=-w,i=0;i<n;i++)q[i][j]=-q[i][j];break}if(y>=f-1)throw"Error: no convergence.";for(u=p[k],v=p[j-1],s=o[j-1],t=o[j],r=((v-w)*(v+w)+(s-t)*(s+t))/(2*t*v),s=b(r,1),r=r<0?((u-w)*(u+w)+t*(v/(r-s)-t))/u:((u-w)*(u+w)+t*(v/(r+s)-t))/u,g=1,x=1,h=k+1;h<j+1;h++){for(s=o[h],v=p[h],t=x*s,s*=g,w=b(r,t),o[h-1]=w,g=r/w,x=t/w,r=u*g+s*x,s=-u*x+s*g,t=v*x,v*=g,i=0;i<n;i++)u=q[i][h-1],w=q[i][h],q[i][h-1]=u*g+w*x,q[i][h]=-u*x+w*g;for(w=b(r,t),p[h-1]=w,g=r/w,x=t/w,r=g*s+x*v,u=-x*s+g*v,i=0;i<m;i++)v=l[i][h-1],w=l[i][h],l[i][h-1]=v*g+w*x,l[i][h]=-v*x+w*g}o[k]=0,o[j]=r,p[j]=u}for(h=0;h<p.length;h++)p[h]<d&&(p[h]=0);for(h=0;h<n;h++)for(i=h-1;i>=0;i--)if(p[i]<p[h]){for(g=p[i],p[i]=p[h],p[h]=g,j=0;j<l.length;j++)c=l[j][h],l[j][h]=l[j][i],l[j][i]=c;for(j=0;j<q.length;j++)c=q[j][h],q[j][h]=q[j][i],q[j][i]=c;h=i}return{U:l,S:p,V:q}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(a,b,c){function d(a){var b=function(a,b,c){return a&&a.hasOwnProperty(b)&&null!==a[b]?a[b]:c},c=b(a,"labels",!0),d=b(a,"crosshairs",!1),e=b(a,"screenbounds",!1),g=b(a,"autoSave",!0),h=b(a,"autoLoad",!0),i=b(a,"layers",[]),j=b(a,"onchange",function(){}),k="maptastic.layers",l=null,m=null,n=[],o=!1,p=!1,q=[],r=null,s=null,t=20,u=null,v=null,w=!1,x=[],y=[],z=[],A=function(a,b,c,d){return Math.sqrt(Math.pow(c-a,2)+Math.pow(d-b,2))},B=function(a,b,c,d){var e=b[1]*d[0]-b[0]*d[1]+(d[1]-b[1])*a[0]+(b[0]-d[0])*a[1],f=b[0]*c[1]-b[1]*c[0]+(b[1]-c[1])*a[0]+(c[0]-b[0])*a[1];if(e<0!=f<0)return!1;var g=-c[1]*d[0]+b[1]*(d[0]-c[0])+b[0]*(c[1]-d[1])+c[0]*d[1];return g<0&&(e=-e,f=-f,g=-g),e>0&&f>0&&e+f<g},C=function(a,b){var c=B(a,b.targetPoints[0],b.targetPoints[1],b.targetPoints[2]),d=B(a,b.targetPoints[3],b.targetPoints[0],b.targetPoints[2]);return c||d},D=function(){j()},E=function(){if(o){m.strokeStyle="red",m.lineWidth=2,m.clearRect(0,0,l.width,l.height);for(var a=0;a<n.length;a++)if(n[a].visible){n[a].element.style.visibility="visible",m.beginPath(),n[a]===v?m.strokeStyle="red":n[a]===r?m.strokeStyle="red":m.strokeStyle="white",m.moveTo(n[a].targetPoints[0][0],n[a].targetPoints[0][1]);for(var b=0;b<n[a].targetPoints.length;b++)m.lineTo(n[a].targetPoints[b][0],n[a].targetPoints[b][1]);m.lineTo(n[a].targetPoints[3][0],n[a].targetPoints[3][1]),m.closePath(),m.stroke();for(var f=[0,0],b=0;b<n[a].targetPoints.length;b++)n[a].targetPoints[b]===u?m.strokeStyle="red":n[a].targetPoints[b]===s?m.strokeStyle="red":m.strokeStyle="white",f[0]+=n[a].targetPoints[b][0],f[1]+=n[a].targetPoints[b][1],m.beginPath(),m.arc(n[a].targetPoints[b][0],n[a].targetPoints[b][1],t/2,0,2*Math.PI,!1),m.stroke();if(f[0]/=4,f[1]/=4,c){var g=n[a].element.id.toUpperCase();m.font="16px sans-serif",m.textAlign="center";var h=m.measureText(g),i=[h.width+8,32];m.fillStyle="white",m.fillRect(f[0]-i[0]/2,f[1]-i[1]+8,i[0],i[1]),m.fillStyle="black",m.fillText(g,f[0],f[1])}}else n[a].element.style.visibility="hidden";if(d&&(m.strokeStyle="yellow",m.lineWidth=1,m.beginPath(),m.moveTo(x[0],0),m.lineTo(x[0],l.height),m.moveTo(0,x[1]),m.lineTo(l.width,x[1]),m.stroke()),e){m.fillStyle="black",m.lineWidth=4,m.fillRect(0,0,l.width,l.height),m.strokeStyle="#909090",m.beginPath();for(var j=l.width/10,k=l.height/10,a=0;a<10;a++)m.moveTo(a*j,0),m.lineTo(a*j,l.height),m.moveTo(0,a*k),m.lineTo(l.width,a*k);m.stroke(),m.strokeStyle="white",m.strokeRect(2,2,l.width-4,l.height-4);var p=Math.round(.6*k);m.font=p+"px mono,sans-serif",m.fillRect(2*j+2,3*k+2,l.width-4*j-4,l.height-6*k-4),m.fillStyle="white",m.fontSize=20,m.fillText(l.width+" x "+l.height,l.width/2,l.height/2+.75*p),m.fillText("display size",l.width/2,l.height/2-.75*p)}}},F=function(a,b,c){var d=a[b][0],e=a[b][1];a[b][0]=a[c][0],a[b][1]=a[c][1],a[c][0]=d,a[c][1]=e},G=function(){l=document.createElement("canvas"),l.style.display="none",l.style.position="fixed",l.style.top="0px",l.style.left="0px",l.style.zIndex="1000000",m=l.getContext("2d"),document.body.appendChild(l),window.addEventListener("resize",T),window.addEventListener("mousemove",K),window.addEventListener("mouseup",L),window.addEventListener("mousedown",M),window.addEventListener("keydown",J),T()},H=function(a,b){for(var c=Math.sin(b),d=Math.cos(b),e=[0,0],f=0;f<a.targetPoints.length;f++)e[0]+=a.targetPoints[f][0],e[1]+=a.targetPoints[f][1];e[0]/=4,e[1]/=4;for(var f=0;f<a.targetPoints.length;f++){var g=a.targetPoints[f][0]-e[0],h=a.targetPoints[f][1]-e[1];a.targetPoints[f][0]=g*d-h*c+e[0],a.targetPoints[f][1]=g*c+h*d+e[1]}},I=function(a,b){for(var c=[0,0],d=0;d<a.targetPoints.length;d++)c[0]+=a.targetPoints[d][0],c[1]+=a.targetPoints[d][1];c[0]/=4,c[1]/=4;for(var d=0;d<a.targetPoints.length;d++){var e=a.targetPoints[d][0]-c[0],f=a.targetPoints[d][1]-c[1];a.targetPoints[d][0]=e*b+c[0],a.targetPoints[d][1]=f*b+c[1]}},J=function(a){if(!o)return 32==a.keyCode&&a.shiftKey?void R(!0):void 0;var b=a.keyCode,c=a.shiftKey?10:1,f=!1,h=[0,0];switch(b){case 32:if(a.shiftKey)return void R(!1);break;case 37:h[0]-=c;break;case 38:h[1]-=c;break;case 39:h[0]+=c;break;case 40:h[1]+=c;break;case 67:d=!d,f=!0;break;case 83:if(w){for(var i=0;i<n.length;i++)n[i].visible=!0;w=!1,f=!0}else if(null!=r){for(var i=0;i<n.length;i++)n[i].visible=!1;r.visible=!0,f=!0,w=!0}break;case 66:e=!e,E();break;case 72:r&&(F(r.sourcePoints,0,1),F(r.sourcePoints,3,2),Q(),E());break;case 86:r&&(F(r.sourcePoints,0,3),F(r.sourcePoints,1,2),Q(),E());break;case 82:r&&(H(r,Math.PI/2),Q(),E())}if(!e)if(s)s[0]+=h[0],s[1]+=h[1],f=!0;else if(r){if(1==a.altKey)H(r,.01*h[0]),I(r,-.005*h[1]+1);else for(var i=0;i<r.targetPoints.length;i++)r.targetPoints[i][0]+=h[0],r.targetPoints[i][1]+=h[1];f=!0}f&&(Q(),E(),g&&O(),D())},K=function(a){if(o)if(a.preventDefault(),y[0]=a.clientX-x[0],y[1]=a.clientY-x[1],x[0]=a.clientX,x[1]=a.clientY,p){var b=a.shiftKey?.1:1;if(s)s[0]+=y[0]*b,s[1]+=y[1]*b;else if(r)if(1==a.altKey)H(r,y[0]*(.01*b)),I(r,y[1]*(-.005*b)+1);else for(var c=0;c<r.targetPoints.length;c++)r.targetPoints[c][0]+=y[0]*b,r.targetPoints[c][1]+=y[1]*b;Q(),g&&O(),E(),D()}else{l.style.cursor="default";var e=a.clientX,f=a.clientY,h=null!=u,i=null!=v;u=null;for(var c=0;c<n.length;c++){var j=n[c];if(j.visible)for(var k=0;k<j.targetPoints.length;k++){var m=j.targetPoints[k];if(A(m[0],m[1],e,f)<t){l.style.cursor="pointer",u=m;break}}}v=null;for(var c=0;c<n.length;c++)if(n[c].visible&&C(x,n[c])){v=n[c];break}(d||h!=(null!=u)||i!=(null!=v))&&E()}},L=function(a){o&&(a.preventDefault(),p=!1)},M=function(a){if(o&&!e){a.preventDefault(),u=null,v?(r=v,p=!0):r=null,s=null;var b=a.clientX,c=a.clientY;z[0]=b,z[1]=c;for(var d=0;d<n.length;d++)for(var f=n[d],g=0;g<f.targetPoints.length;g++){var h=f.targetPoints[g];if(A(h[0],h[1],b,c)<t){r=f,s=h,p=!0,q[0]=a.clientX-h[0],q[1]=a.clientY-h[1];break}}return E(),!1}},N=function(a,b){var c;if("string"==typeof a){if(!(c=document.getElementById(a)))throw"Maptastic: No element found with id: "+a}else a instanceof HTMLElement&&(c=a);for(var d=0;d<n.length;d++)n[d].element.id==c.id&&(n[d].targetPoints=S(layout[h].targetPoints),!0);var e=c.offsetLeft,f=c.offsetTop;c.style.position="fixed",c.style.display="block",c.style.top="0px",c.style.left="0px",c.style.padding="0px",c.style.margin="0px";var g={visible:!0,element:c,width:c.clientWidth,height:c.clientHeight,sourcePoints:[],targetPoints:[]};if(g.sourcePoints.push([0,0],[g.width,0],[g.width,g.height],[0,g.height]),b)g.targetPoints=S(b);else{g.targetPoints.push([0,0],[g.width,0],[g.width,g.height],[0,g.height]);for(var h=0;h<g.targetPoints.length;h++)g.targetPoints[h][0]+=e,g.targetPoints[h][1]+=f}n.push(g),Q()},O=function(){localStorage.setItem(k,JSON.stringify(U(n)))},P=function(){if(localStorage.getItem(k)){for(var a=JSON.parse(localStorage.getItem(k)),b=0;b<a.length;b++)for(var c=0;c<n.length;c++)n[c].element.id==a[b].id&&(n[c].targetPoints=S(a[b].targetPoints),n[c].sourcePoints=S(a[b].sourcePoints));Q()}},Q=function(){for(var a=(["","-webkit-","-moz-","-ms-","-o-"].reduce(function(a,b){return b+"transform"in document.body.style?b:a})+"transform"),b=0;b<n.length;b++){for(var c=[],d=[],e=0,g=n[b].sourcePoints.length;e<g;++e){var h=n[b].sourcePoints[e],i=n[b].targetPoints[e];c.push([h[0],h[1],1,0,0,0,-h[0]*i[0],-h[1]*i[0]]),d.push(i[0]),c.push([0,0,0,h[0],h[1],1,-h[0]*i[1],-h[1]*i[1]]),d.push(i[1])}var j=f(c,d,!0),k=[j[0],j[3],0,j[6],j[1],j[4],0,j[7],0,0,1,0,j[2],j[5],0,1];n[b].element.style[a]="matrix3d("+k.join(",")+")",n[b].element.style[a+"-origin"]="0px 0px 0px"}},R=function(a){o=a,l.style.display=a?"block":"none",a?E():(s=null,r=null,p=!1,e=!1)},S=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].slice(0,2));return b},T=function(){l.width=window.innerWidth,l.height=window.innerHeight,E()},U=function(){for(var a=[],b=0;b<n.length;b++)a.push({id:n[b].element.id,targetPoints:S(n[b].targetPoints),sourcePoints:S(n[b].sourcePoints)});return a},V=function(a){for(var b=0;b<a.length;b++){for(var c=!1,d=0;d<n.length;d++)n[d].element.id==a[b].id&&(console.log("Setting points."),n[d].targetPoints=S(a[b].targetPoints),n[d].sourcePoints=S(a[b].sourcePoints),c=!0);if(c)console.log("Maptastic: Element '"+a[b].id+"' is already mapped.");else{var e=document.getElementById(a[b].id);e?N(e,a[b].targetPoints):console.log("Maptastic: Can't find element: "+a[b].id)}}Q(),E()};G();for(var W=0;W<i.length;W++)(i[W]instanceof HTMLElement||"string"==typeof i[W])&&N(i[W]);for(var W=0;W<arguments.length;W++)(arguments[W]instanceof HTMLElement||"string"==typeof arguments[W])&&N(arguments[W]);return h&&P(),{getLayout:function(){return U()},setLayout:function(a){V(a)},setConfigEnabled:function(a){R(a)},addLayer:function(a,b){N(a,b)}}}var e=a("numeric"),f=e.solve;"function"==typeof define&&define.amd?define(["maptastic"],function(){return d}):"object"===(void 0===b?"undefined":_typeof(b))&&b.exports?b.exports=d:window.Maptastic=d},{numeric:1}]},{},[2]);